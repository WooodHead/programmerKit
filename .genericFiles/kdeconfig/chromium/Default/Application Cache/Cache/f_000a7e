cw.prototype.M8=LO(59,function(){return Su(this,3)});bD.prototype.M8=LO(58,function(){return Su(this,5)});cw.prototype.p6=LO(57,function(){return W(this,3)});bD.prototype.p6=LO(56,function(){return W(this,5)});cw.prototype.O8=LO(55,function(){return Su(this,2)});bD.prototype.O8=LO(54,function(){return Su(this,4)});cw.prototype.C6=LO(53,function(){return W(this,2)});bD.prototype.C6=LO(52,function(){return W(this,4)});function hRd(a,b){$f(a,11,b)}function iRd(a,b,c){return"r"==c?smb(a,b):tmb(a,b)}
function jRd(a,b){return(a=GR(a,b))?a.rect:null}function kRd(a,b){a.D=b}function lRd(a,b,c){c=void 0===c?!0:c;Tp.call(this,"docs-material-dialog",a,b);eq(this,null);dq(this,!0);$p(this,this.XJ?0:.6);this.O=new KR("Ok");this.Ia(this.O);(this.C=c?new LR("Cancel"):null)&&this.Ia(this.C)}q(lRd,Tp);p=lRd.prototype;
p.Ja=function(){var a=this;Tp.prototype.Ja.call(this);this.getHandler().V(this.O,"action",function(){return a.k8()}).V(this.$a(),"keypress",this.DJb);this.C&&this.getHandler().V(this.C,"action",function(){a.dispatchEvent("Hc")&&a.setVisible(!1)})};p.DJb=function(a){13==a.keyCode&&(a.target==oDa(this)||this.C&&a.target==this.C.getElement()?this.dispatchEvent("Hc")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.k8())};
p.k8=function(){this.dispatchEvent("Gc")&&this.setVisible(!1)};p.Da=function(){Tp.prototype.Da.call(this);var a=Yp(this);this.C&&this.C.render(a);this.O.render(a);M(a,!0);vq(oDa(this),eCc)};p.qz=function(a){Tp.prototype.qz.call(this,a);$p(this,this.XJ?0:.6)};function mRd(a){Wf(this,a,0,-1,null,null)}x(mRd,Vf);function nRd(a){Wf(this,a,0,-1,null,null)}x(nRd,Vf);var oRd=/['()]/g;function pRd(a){return"%"+a.charCodeAt(0).toString(16)}
function qRd(a){a=Qb(String(a));oRd.lastIndex=0;return oRd.test(a)?a.replace(oRd,pRd):a}function rRd(a){return a.Al()+$b(a.C)}
function sRd(a){var b=Q;var c=Eq(""+P(a.V2b));c='<div class="docs-unsupportedofficefeatureswarning-content-header"><div class="docs-unsupportedofficefeatureswarning-content-header-warningtext">'+P(c)+'</div><div class="docs-unsupportedofficefeatureswarning-content-header-restorefiletext">';c=Q(c+"The original file can be restored from version history</div></div>");var d='<div class="docs-unsupportedofficefeatureswarning-content-features-list">';a=a.qd;for(var e=a.length,f=0;f<e;f++)d+=Q('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+
P({feature:Dq(""+a[f])}.feature)+"</div>");d=Q(d+"</div>");return b(c+d)};function B2(a,b,c,d){Vs.call(this,"docs-unsupportedofficefeatureswarning",void 0,d);this.Aa=b;this.Ea=c;this.J=new KR(this.qDa());this.Ia(this.J);this.C=null;this.K8()&&(this.C=new KR(this.DDa()),this.Ia(this.C));this.F=null;a.F&&I(H(),"docs-esdttfl")&&(this.F=new LP("warning-dialogs",!1,d),this.Ia(this.F));eq(this,null);dq(this,!1);this.qz(!1);this.Hi=!0}x(B2,Vs);p=B2.prototype;p.Uka=n("alertdialog");
p.Da=function(){B2.oa.Da.call(this);vq(this.Pb(),sRd,{qd:this.Aa,V2b:this.Ea},void 0);var a=Yp(this);this.F&&this.F.render(a);this.J.render(a);this.K8()&&this.C.render(a);M(a,!0);M(Xp(this),!1);pq(this,null);L(this.$a(),this.AAa())};p.Ja=function(){var a=this;B2.oa.Ja.call(this);this.getHandler().V(this.J,"action",function(){return a.Qla()});this.K8()&&this.getHandler().V(this.C,"action",function(){a.setVisible(!1)})};p.Qla=function(){this.setVisible(!1)};p.K8=Qe;p.DDa=ta;function tRd(a,b,c,d,e,f){B2.call(this,a,b,c,d);this.L=!1;this.R=e;this.O=f}x(tRd,B2);p=tRd.prototype;p.AAa=n("docs-editconsentdialog");p.qDa=n("Continue Editing");p.K8=Re;p.DDa=n("Cancel");p.Qla=function(){tRd.oa.Qla.call(this);this.L=!0;this.R.gc()};p.um=function(){tRd.oa.um.call(this);this.L||this.O.gc()};function uRd(a,b,c,d){B2.call(this,a,b,c,d)}x(uRd,B2);uRd.prototype.AAa=n("docs-unsupportedfeatureslistdialog");uRd.prototype.qDa=n("Ok");function vRd(a){return Q('<input type="text" id="docs-copy-link" class="'+S("docs-copy-link")+'" value="'+S(a.link)+'" readonly="readonly">')};function C2(a,b,c,d){Vs.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ea="";this.F=b||null;this.Aa=c||new dzb(a);this.R=null!=d?d:null;a=new bq;gq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Aa.C()&&gq(a,{key:"copy-link",caption:"Copy Link"});eq(this,a)}x(C2,Vs);p=C2.prototype;
p.Da=function(){C2.oa.Da.call(this);L(Zp(this),"copy-link-dialog");L(fq(this.D,"done"),"copy-link-done-button");this.C=O(vRd,{link:this.Ea},void 0,this.va());Hh(this.C,"label","Link to this comment");this.Pb().appendChild(this.C);if(this.L=fq(this.D,"copy-link")){var a=ge("DIV");L(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Xp(this));this.O=new Xo(a);this.J=Zo("Link copied to clipboard.","info",!1,4E3)}null!==this.R&&(ci(this.gr(),"z-index",this.R),ci(Zp(this),"z-index",this.R+1))};
p.Ll=function(){C2.oa.Ll.call(this);this.F&&this.getHandler().V(this.F,"copy",this.jBa);this.C.focus();this.C.select()};p.um=function(){C2.oa.um.call(this);this.F&&this.getHandler().Pc(this.F,"copy",this.jBa)};p.Ja=function(){C2.oa.Ja.call(this);this.getHandler().V(this.C,"click",this.hTb);this.L&&this.getHandler().V(this.L,"click",this.Cnb)};p.PTb=function(a){this.Ea=a;this.C&&(this.C.value=a)};p.hTb=function(a){a.target.focus();a.target.select()};
p.Cnb=function(a){a.stopPropagation();this.F&&this.Aa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.jBa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Ha=function(){C2.oa.Ha.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function wRd(a){var b=a.description;a=a.pRb;return Q('<div class="waffle-dv-rec-chip" title="'+S(b)+'"><div class="waffle-dv-rec-range">'+P(a)+'</div><div class="waffle-dv-rec-description">'+P(b)+"</div></div>")}function xRd(){return Q('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function D2(){var a=new XL(null);PO(a,!0);return a};function yRd(a,b,c){E.call(this);this.D=a;this.Lf=b;this.$b=c;this.R=this.H=this.Ga=this.Ea=this.ma=this.F=null;this.rc=new wP;this.Ba(this.rc);this.ue=new wP;this.Ba(this.ue);this.Aa=this.O=null;this.Dd=new wP;this.Ba(this.Dd);this.Qe=new wP;this.Ba(this.Qe);this.fb=this.Na=this.Oa=this.qa=this.L=null;this.Kd=new wP;this.Ba(this.Kd);this.ge=new wP;this.Ba(this.ge);this.dd=new wP;this.Ba(this.dd);this.Ge=new wP;this.Ba(this.Ge);this.mb=this.Vc=null;this.C=new GT("");this.Ba(this.C);this.sb=this.J=
this.Jb=this.Hb=this.Ye=this.Hc=this.Sb=this.Fb=null;this.Dg=this.od=!1;this.Ob=this.Af=this.jb=this.Bb=null;this.rf=new Uh(this);this.Ba(this.rf);this.$c=new $u;this.jg=this.uh=this.Ng=this.Vf=this.Og=this.La=null;this.Mx();a=this.rf;a.V(this.F,"action",this.ktb);a.V(this.ma,"action",this.Ama);a.V(this.Ea,"action",this.Ama);a.V(this.Ga,"action",this.Ama);a.V(this.J,"focus",Da(this.zRa,!0));a.V(this.J,"blur",Da(this.zRa,!1));a.V(this.J,"change",this.nma);a.V(this.J,"keyup",this.nma);b=[this.O,this.Aa,
this.H,this.R,this.L,this.qa,this.Na,this.fb];for(c=0;c<b.length;c++)this.rf.V(b[c],"change",v(this.CZb,this,b[c])),this.rf.V(b[c],"keyup",v(this.ftb,this,b[c]));a.V(this.jb,"change",v(this.mJa,this));a.V(this.Oa,"change",v(this.fFb,this));a.Bg(this.sb,pf,this.qAb)}x(yRd,E);var zRd="placeholder"in document.createElement("input"),ARd=/\s*,\s*/;
function BRd(a){var b=a.jg;b||(b=[{cj:"List from a range",type:4},{cj:"List of items",type:3},{cj:"Number",type:0},{cj:"Text",type:1},{cj:"Date",type:2},{cj:"Custom formula is",type:5}],I(H(),"fecdv")&&b.push({cj:"Checkbox",type:6}),a.jg=b);return b}
function CRd(a){var b=a.uh;b||(b=[{cj:"contains",code:9,inputs:0,example:"Approved"},{cj:"does not contain",code:10,inputs:0,example:"Approved"},{cj:"equals",code:13,inputs:0,example:"Approved"},{cj:"is valid email",code:14,inputs:-1,example:null},{cj:"is valid url",code:15,inputs:-1,example:null}],a.uh=b);return b}
function DRd(a){var b=a.Vf;b||(b=[{cj:"is valid date",code:30,inputs:-1,example:null},{cj:"equal to",code:16,inputs:2,example:"11/15/2014"},{cj:"before",code:17,inputs:2,example:"11/15/2014"},{cj:"on or before",code:19,inputs:2,example:"11/15/2014"},{cj:"after",code:18,inputs:2,example:"11/15/2014"},{cj:"on or after",code:20,inputs:2,example:"11/15/2014"},{cj:"between",code:21,inputs:3,example:"11/15/2014",UP:"11/15/2015"},{cj:"not between",code:22,inputs:3,example:"11/15/2014",UP:"11/15/2015"}],
a.Vf=b);return b}function ERd(a){var b=a.Ng;b||(b=[{cj:"range",code:23,inputs:6,example:null},{cj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Ng=b);return b}
function FRd(a){var b=a.Og;b||(b=[{cj:"between",code:7,inputs:8,example:"10",UP:"100"},{cj:"not between",code:8,inputs:8,example:"10",UP:"100"},{cj:"less than",code:3,inputs:7,example:"10"},{cj:"less than or equal to",code:4,inputs:7,example:"10"},{cj:"greater than",code:1,inputs:7,example:"10"},{cj:"greater than or equal to",code:2,inputs:7,example:"10"},{cj:"equal to",code:5,inputs:7,example:"10"},{cj:"not equal to",code:6,inputs:7,example:"10"}],a.Og=b);return b}
function GRd(){return{cj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function HRd(){return{cj:"",code:31,inputs:-1,example:""}}p=yRd.prototype;
p.Mx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J=a.va(),R;var aa=J.Da("TR","waffle-dv-trrules",J.Da("TD","waffle-dv-label",J.Da("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),J.Da("TD",{colspan:"7"},l=J.Da("DIV","goog-inline-block"),R=J.Da("DIV","goog-inline-block"),h=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=J.Da("SPAN","waffle-dv-separator","and"),k=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.dd.rb(h);this.Ge.rb(k);this.Dd.rb(c);this.Qe.rb(d);this.rc.rb(e);this.ue.rb(f);var V=D2();Li(V,l);var ka=D2();Li(ka,l);var oa=D2();Li(oa,l);var Aa=D2();Li(Aa,l);var Ga=IRd(a,R);(w=V.getElement())&&Hh(w,"labelledby","waffle-dv-criteria");
var La;var Ja=J.Da("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Da("TD"),J.Da("TD",{colspan:"7"},La=J.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new $s;Ys(w,La);Li(w,La);var $a=J.Da("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Da("TD"),J.Da("TD",{colspan:"7"},m=J.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Ab=new $s;Ys(Ab,m);Li(Ab,m);var ob=J.Da("TR","waffle-dv-trrules",J.Da("TD"),J.Da("TD","waffle-dv-customcheckboxlabel",
J.Da("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),J.Da("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var ab=J.Da("TR","waffle-dv-trrules",J.Da("TD"),J.Da("TD","waffle-dv-customcheckboxlabel",J.Da("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),J.Da("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=J.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Kd.rb(r);
this.ge.rb(u);Hh(r,"labelledby","customCheckboxInputLabel_checked");Hh(u,"labelledby","customCheckboxInputLabel_unchecked");zP(this.Kd,"e.g., TRUE");zP(this.ge,"e.g., FALSE");var Nc=J.Da("TR","waffle-dv-trrules",J.Da("TD","waffle-dv-label",J.Da("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),J.Da("TD",{colspan:"7"},J.Da("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},J.Da("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),J.Da("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),J.Da("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),J.Da("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new VMc(!0);WMc(m,"onInvalidData",Nc);var hc=J.Da("TR","waffle-dv-trrules waffle-dv-trrules-appearance",J.Da("TD",null,J.Da("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),J.Da("TD",{colspan:"7"},y=J.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Yc=new $s;Ys(Yc,y);Li(Yc,y);y=Yc.$a();var bd=Zia(y,"labelledby");Hh(y,"labelledby","waffle-dv-appearance "+bd);y=J.Da("TR","waffle-dv-trrules",J.Da("TD"),J.Da("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=J.Da("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),bd=J.Da("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));Be(bd,!0);a=a.Ea.childNodes[0];J.appendChild(a,aa);J.appendChild(a,
Ja);J.appendChild(a,$a);J.appendChild(a,ob);J.appendChild(a,ab);J.appendChild(a,Nc);J.appendChild(a,hc);J.appendChild(a,y);this.C.render(l);J=this.C;J.Woa=29;J.resize();J=this.C;J.EMa=200;J.resize();this.C.getElement().style.width="324px";zRd?this.C.getElement().placeholder="Enter items separated by a comma...":(J=this.C.getElement(),tj(J,"Enter items separated by a comma...","Enter items separated by a comma..."));if(J=this.C.getElement())Lh(J,"Enter items separated by a comma..."),Oh(J,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;V.setVisible(!0);J=BRd(this);JRd(this,J,V);J=FRd(this);JRd(this,J,Aa);J=CRd(this);JRd(this,J,ka);J=DRd(this);JRd(this,J,oa);KRd(this,V,Aa,ka,oa,h,k,c,d,e,f,b,l,Ga,Ja,y,w,La,bd,Yc,R,m,Ab,r,u,$a,ob,ab)};
function KRd(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J,R,aa,V,ka,oa,Aa,Ga,La,Ja,$a,Ab,ob){a.F=b;a.F.setVisible(!0);a.Ea=c;a.ma=e;a.Ga=d;a.Vc=u;a.L=f;a.qa=h;a.O=k;a.Aa=l;a.H=m;a.R=r;a.mb=w;a.La=y;a.Fb=oa;a.Oa=Ga;a.Na=La;a.fb=Ja;a.Ye=$a;a.Hb=Ab;a.Jb=ob;M(a.Ye,!1);M(a.Hb,!1);M(a.Jb,!1);ka.Bc(!1);a.jb=ka;a.Ob=Aa;LRd(a,!1);a.Sb=B;R.Bc(!0);a.Bb=R;a.Af=aa;a.Hc=J;M(a.Hc,!0);MRd(a);NRd(a);a.sb=V;M(a.sb,!1)}
function ORd(a,b){M(a.Sb,23==b||24==b);a.Af.innerText="Show dropdown list in cell";b=31==b;M(a.Ye,b);var c=a.Oa.isChecked();M(a.Hb,b&&c);M(a.Jb,b&&c)}function PRd(a){KRd(a,a.F,a.Ea,a.Ga,a.ma,a.L,a.qa,a.O,a.Aa,a.H,a.R,a.Vc,a.mb,a.La,a.Sb,a.Hc,a.Bb,a.Af,a.sb,a.jb,a.Fb,a.Ob,a.Oa,a.Na,a.fb,a.Ye,a.Hb,a.Jb)}function JRd(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.va();e=new Rk(b[d].cj,null,e);c.Ad(e);Gh(e.getElement(),"menuitem")}c.Xe(0)}p.Ama=function(){NRd(this);this.J.value=QRd(this);this.dispatchEvent("change")};
p.ktb=function(){MRd(this);NRd(this);this.J.value=QRd(this);this.dispatchEvent("change")};p.zRa=da("Dg");p.nma=function(a){this.od||a&&!wla(a)||this.J.value===RRd(this)||(this.od=!0,M(this.sb,!0))};p.qAb=function(){this.od=!1;this.J.value=QRd(this);M(this.sb,!1)};p.mJa=function(){M(this.Hc,this.jb.isChecked())};p.fFb=function(){var a=this.Oa.isChecked();a||SRd(this);M(this.Hb,a);M(this.Jb,a);TRd(this)};function TRd(a){a.J.value=QRd(a)}function URd(a){TRd(a);a.C.resize()}
p.CZb=function(a){TRd(this);VRd(this,a)?(this.D.ul=0,E2(a),this.dispatchEvent("change")):(this.D.ul=1,F2(a),this.dispatchEvent("error"))};p.ftb=function(){this.dispatchEvent("keyup")};function VRd(a,b){if(0!=G2(a))return!0;var c=b.value;if(null!=c&&Ai(b)){if(!H2(a.D))return!0;a=I2(a,c,WRd(a).code);return null!=a&&(Su(a,3)||Su(a,5)&&a.Go().Cd()&&3==W(a.Go().getValue(),1))}return!0}function F2(a){a.select();L(a,"waffle-input-error")}function E2(a){a&&Ph(a,"waffle-input-error")}
function SRd(a){E2(a.C.getElement());E2(a.H);E2(a.R);E2(a.L);E2(a.qa);E2(a.Na);E2(a.O);E2(a.Aa);E2(a.La.Gr());a.D.ul=0;a.dispatchEvent("change")}function G2(a){return BRd(a)[a.F.Rg()].type}function MRd(a){var b=G2(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.ma.setVisible(c);a.Ea.setVisible(d);a.Ga.setVisible(e);M(a.mb,f);M(a.Fb,h);M(a.L,!1);M(a.qa,!1);M(a.O,!1);M(a.Aa,!1);M(a.H,!1);M(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function WRd(a){var b;null!=XRd(a)?b=XRd(a):a.ma.isVisible()?b=DRd(a)[a.ma.Rg()]:a.Ea.isVisible()?b=FRd(a)[a.Ea.Rg()]:5==G2(a)?b=GRd():6==G2(a)?b=HRd():b=CRd(a)[a.Ga.Rg()];return b}function XRd(a){var b=ERd(a);return 4==G2(a)?b[0]:3==G2(a)?b[1]:null}
function NRd(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=WRd(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=WRd(a);if(3==G2(a))zRd?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),tj(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)zP(a.Dd,"e.g., "+
u.example),zP(a.Qe,"e.g., "+u.UP||"");else if(2==u.inputs||3==u.inputs)zP(a.rc,"e.g., "+u.example),zP(a.ue,"e.g., "+u.UP||"");else if(7==u.inputs||8==u.inputs)zP(a.dd,"e.g., "+u.example),zP(a.Ge,"e.g., "+u.UP||"");SRd(a);M(a.L,b);M(a.qa,c);M(a.O,d);M(a.Aa,e);M(a.H,f);M(a.R,h);M(a.mb,l);l&&a.C.resize();M(a.Fb,m);ORd(a,r.code);M(a.Vc,k)}
function I2(a,b,c){var d=H2(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.Cc();e=e.Ac();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.$c.Bd(Av.Ca(),b):null}
function YRd(a){var b=new Fv,c=WRd(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(I2(a,a.O.value,d));break;case 1:e.push(I2(a,a.O.value,d));e.push(I2(a,a.Aa.value,d));break;case 2:e.push(I2(a,a.H.value,d));break;case 3:e.push(I2(a,a.H.value,d));e.push(I2(a,a.R.value,d));break;case 7:e.push(I2(a,a.L.value,d));break;case 8:e.push(I2(a,a.L.value,d));e.push(I2(a,a.qa.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(MDc(a[c]));break;case 6:c=Qnb("="+a.La.getValue());e.push(I2(a,
c,d));break;case -1:a.Oa.isChecked()&&(e.push(I2(a,Ob(a.Na.value),d)),Lb(a.fb.value)||e.push(I2(a,Ob(a.fb.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=hS(d,e);X(b,1,d);return b}function ZRd(a){var b=Ob(a.La.getValue());!a.$b.D.D[Ob($b(b).toLowerCase())]&&FR(a.$b,b)&&(b=UBc(a.$b,b,!0));return b}function QRd(a){return a.od||a.Dg?a.J.value:RRd(a)}
function RRd(a){var b="";var c=G2(a);var d=4==c;c=3==c||4==c;if(a.ma.isVisible())c=DRd(a)[a.ma.Rg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ga.isVisible())c=CRd(a)[a.Ga.Rg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=XRd(a),b+="Click and enter a value from ";else if(5==G2(a))c=GRd(),b="Enter a value that satisfies the formula:";else if(6==G2(a))if(c=HRd(),a.Oa.isChecked()&&!Lb(Ob(a.Na.value))){b=Ob(a.Na.value);
var e=Ob(a.fb.value);b=Lb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=FRd(a)[a.Ea.Rg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.cj);e=ZRd(a);23==c.code&&""!=e&&d&&(d=UBc(a.$b,e,!0))&&(b+=" "+d);Lb($b(a.O.value))||0!=c.inputs&&1!=c.inputs?Lb($b(a.H.value))||2!=c.inputs&&3!=c.inputs?Lb($b(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Lb($b(a.Aa.value))||1!=c.inputs?Lb($b(a.R.value))||3!=c.inputs?Lb($b(a.qa.value))||
8!=c.inputs||(b+=" and "+a.qa.value):b+=" and "+a.R.value:b+=" and "+a.Aa.value;return b}function LRd(a,b){XMc(a.Ob,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function J2(a,b){switch(b){case 0:a.F.Xe(2);break;case 1:a.F.Xe(3);break;case 2:a.F.Xe(4);break;case 3:a.F.Xe(1);break;case 4:a.F.Xe(0);break;case 5:a.F.Xe(5);break;case 6:a.F.Xe(6)}}
function $Rd(a,b,c,d,e){a.F.Xe(0);a.ma.Xe(0);a.Ea.Xe(0);a.Ga.Xe(0);a.J.value="";a.L.value="";a.qa.value="";a.H.value="";a.R.value="";a.O.value="";a.Aa.value="";a.C.eb("");a.La.eb("");LRd(a,!1);var f=a.od=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,J=!1,R=!1,aa=!1,V=!1,ka=!1,oa=!1,Aa=!1,Ga=!1,La=b&&Gv(b);b=La&&Cv(La);if((La=La&&Dv(La))&&b){for(var Ja=ERd(a),$a=DRd(a),Ab=FRd(a),ob=CRd(a),ab=GRd(),Nc=HRd(),hc=0,Yc=0;Yc<Ja.length;Yc++)if(b==Ja[Yc].code){hc=Ja[Yc].inputs;23==Ja[Yc].code?(oa=!0,J2(a,
4)):(R=!0,J2(a,3));a.Bb.Bc(!!e);break}for(e=0;e<$a.length;e++)if(b==$a[e].code){hc=$a[e].inputs;a.ma.Xe(e);J2(a,2);aa=w=!0;break}for(e=0;e<Ab.length;e++)if(b==Ab[e].code){hc=Ab[e].inputs;a.Ea.Xe(e);J2(a,0);V=y=!0;break}for(e=0;e<ob.length;e++)if(b==ob[e].code){hc=ob[e].inputs;a.Ga.Xe(e);J2(a,1);ka=B=!0;break}b==ab.code&&(hc=ab.inputs,J2(a,5),Aa=!0);b==Nc.code&&(hc=Nc.inputs,J2(a,6),Ga=!0);if(aa||ka||V||R||oa||Aa||Ga)if(ka=H2(a.D),aa=ka.rect.Cc(),V=ka.rect.Ac(),ka=ka.C,-1==hc)Ga&&0<La.length&&(J=!0,
a.Oa.Bc(!0),a.Kd.eb(BE(La[0],ka,aa,V)),1<La.length&&a.ge.eb(BE(La[1],ka,aa,V)));else if(0==hc)m=BE(La[0],ka,aa,V),a.Dd.eb(m),m=!0;else if(1==hc)r=BE(La[0],ka,aa,V),m=BE(La[1],ka,aa,V),a.Dd.eb(r),a.Qe.eb(m),r=m=u=!0;else if(2==hc)f=BE(La[0],ka,aa,V),a.rc.eb(f),f=!0;else if(3==hc)h=BE(La[0],ka,aa,V),f=BE(La[1],ka,aa,V),a.rc.eb(h),a.ue.eb(f),h=f=u=!0;else if(7==hc)k=BE(La[0],ka,aa,V),a.dd.eb(k),k=!0;else if(8==hc)l=BE(La[0],ka,aa,V),k=BE(La[1],ka,aa,V),a.dd.eb(l),a.Ge.eb(k),l=k=u=!0;else if(5==hc){R=
!0;Ga=[];for(hc=0;hc<La.length;hc++)Ga.push(BE(La[hc],ka,aa,V));a.C.eb(Ga.join(","));a.C.resize()}else 6==hc&&(oa=!0,Ga=BE(La[0],ka,aa,V),null!=Ga&&(Ga=Ga.substring(1),La=!!WF(Ga),Ga=(hc=YF(Ga,a.Lf,!1,!0))?$F(hc.rect,OF(a.Lf,hc.C).pe()):Ga,La||(Ga=XF(Ga)),a.La.eb(Ga)));else a.F.Xe(0),oa=!0;M(a.Vc,u);a.ma.setVisible(w);a.Ea.setVisible(y);a.Ga.setVisible(B);M(a.H,f);M(a.R,h);M(a.O,m);M(a.Aa,r);M(a.L,k);M(a.qa,l);M(a.Hb,J);M(a.Jb,J);M(a.Sb,!0);M(a.mb,R);a.C.resize();M(a.Fb,oa);null!=b&&ORd(a,b)}else{if(I(H(),
"feadv")){w=UH(a.Lf);y=w.Rc();B=new Nm;for(J=y.Cc();J<y.cd();J++)for(R=y.Ac();R<y.hd();R++)oa=w.ih(J,R),""!=ME(oa)&&Qm(B,ME(oa).split(ARd));B.isEmpty()?w=!1:(PRd(a),a.C.eb(B.zd().join(",")),J2(a,3),MRd(a),w=!0)}else w=!1;w||PRd(a)}a.mJa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Tb(Ob(c.substring(w+9))));a.jb.Bc(!!c);c&&(QRd(a)!=c&&a.nma(),a.J.value=c,M(a.Hc,!0));LRd(a,d)}
p.Ha=function(){this.Sb=this.Bb=this.sb=this.J=this.Vc=this.fb=this.Na=this.qa=this.L=this.Aa=this.O=this.R=this.H=null;C(this.La);this.La=null;C(this.Bb);this.Bb=null;C(this.Ga);this.Ga=null;C(this.Ea);this.Ea=null;C(this.ma);this.ma=null;C(this.F);this.F=null;C(this.jb);this.jb=null;C(this.Ob);this.Ob=null;yRd.oa.Ha.call(this)};function aSd(a,b,c,d,e,f,h){Tp.call(this);this.Jb=a;this.Qe=b;this.Bb=c;this.ue=d;this.O=e;this.jb=f;this.Hb=h;this.R=new N(this.va());this.Ia(this.R);this.Vc=new yq("",new NT,this.va());this.Ia(this.Vc);this.mb=new N(this.va());this.Ia(this.mb);this.Oa=new LT(!1,"#4285f4");this.Ia(this.Oa);this.od=new OT(c,bSd.Eda,bSd.Fda);this.Ba(this.od);this.F=this.Ea=null;this.dd=new Uh(this);this.Ba(this.dd);this.Fb=this.Aa=this.J=this.C=null;this.fb=I(H(),"fedvs");this.sb=this.L=null;this.Ob=-1;this.rc=[];
this.$b=[];this.Dd=-1;a=BD(this.Bb).Rc();this.Ge=tw(a.Cc(),a.Ac(),a.cd(),a.hd());this.Sb=!1;this.Hc=new Uh(this);this.Ba(this.Hc);this.Aa=new bq;this.Aa.set("save","Save",!1);this.Aa.set("clear","Remove validation",!1,!1);this.Aa.set("cancel","Cancel",!1,!0);eq(this,this.Aa);aq(this,!1);this.render();a=this.Pb();b=this.va();c=bSd;Up(this,"Data validation");this.J||(d=b.Da("DIV",{"class":c.XVa}),e=b.Da("DIV",{"class":c.WVa},d),b.appendChild(a,e),this.J=new Wo(e),this.J.setType("warning"),this.J.setContent(""),
this.J.render(d),xwa(this.J,!0),this.J.setVisible(!1));this.fb&&(e=b.Da("DIV",c.v1a),f=b.Da("DIV",{id:cSd.ywa},"Suggested validations"),d=b.Da("DIV",c.u1a),h=b.Da("DIV",c.Pua,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Vc.rb(h),M(h,uz),this.R.rb(d),e=b.Da("DIV",c.Z0a),b.appendChild(d,e),this.mb.rb(e),this.Oa.render(e),MT(this.Oa,!0));this.Ea=b.Da("TABLE",{cellSpacing:"0","class":c.bB},b.Da("TBODY"));b.appendChild(a,this.Ea);this.fb&&L(this.Ea,
c.D1a);a=this.Pb();a=Td(a);b=a.Da("TR",bSd.V1a);b.appendChild(a.Da("TD","waffle-dv-label",a.Da("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Da("TD",{colspan:"7"});this.C=IRd(this,c);dSd(this);b.appendChild(c);a.appendChild(this.Ea.childNodes[0],b);(a=this.C.Gr())&&Hh(a,"labelledby","waffle-dv-cell-range");this.F=new yRd(this,this.Jb,this.O);pq(this,"save");eSd(this)}x(aSd,Tp);
var bSd={WVa:"waffle-input-error-butter-container",XVa:"waffle-input-error-butter-wrap",Pua:"waffle-dv-feedback-link",Eda:"waffle-dv-highlight-styled-border",Fda:"waffle-dv-highlight-styled-rect",hva:"waffle-input-error",Z0a:"waffle-dv-rec-spinner-container",Bea:"waffle-dv-rec-chip-selected",u1a:"waffle-dv-rec-wrapper",v1a:"waffle-dv-recs-title-bar",bB:"waffle-dv-table",D1a:"waffle-dv-table-with-suggestions",V1a:"waffle-dv-trrules"},cSd={ywa:"waffle-dv-recs-title"};p=aSd.prototype;p.ul=0;
function dSd(a){if(a.C){var b=a.Jb.getActiveGrid();b&&(b=$F(BD(a.Bb).Rc(),b.pe(),!0),a.C.eb(b))}}function eSd(a){a.dd.V(a,"dialogselect",a.BZb).V(a.F,"error",a.dtb).V(a.F,"change",a.AZb).V(a.C,"change",function(){a.F&&TRd(a.F);if(a.fb){var b=H2(a);a.Sb||a.L&&b&&b.intersects(GR(a.O,a.sb))||fSd(a)}});a.fb&&a.dd.V(a.jb,"recommender-calc-ended",a.zZb).V(a.Vc,"action",function(){K.vt.gc({source:"dataValidationDialogFeedback"})})}p.dtb=function(){gSd(this)};
p.AZb=function(){gSd(this);hq(this.Aa,"save",!0)};function hSd(a){var b=a.va();a=a.R.$a();var c=O(xRd);b.appendChild(a,c)}
p.zZb=function(a){var b=this;MT(this.Oa,!1);M(this.mb.$a(),!1);a=a.C;if(0==a.length)hSd(this);else for(var c=this.va(),d=this.R.$a(),e=0,f={We:0};f.We<a.length;f={uN:f.uN,KD:f.KD,D0:f.D0,We:f.We,kf:f.kf,yD:f.yD},f.We++){var h=a[f.We],k=W(h,13);if(3<=e||!k)break;e++;f.kf=AR(h);f.D0=$F(Uw(f.kf));f.KD=W(k,3);this.rc.push(f.KD);this.$b.push(f.D0);h="";switch(Cv(f.KD)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+Dv(f.KD).map(function(a){return W(a.Go().getValue(),
2)}).join();break;case 1:h="Greater than "+W(Dv(f.KD)[0].Go().getValue(),3);break;case 7:h=Dv(f.KD);h="Between "+(W(h[0].Go().getValue(),3)+(" and "+W(h[1].Go().getValue(),3)));break;case 5:h=Dv(f.KD);h="Equal to "+W(h[0].Go().getValue(),3);break;default:zmc.C("Unrecognized data validation type.")}k=cSd;f.yD=O(wRd,{description:h,pRb:f.D0});f.uN=new Rq("",c);f.uN.mf(8,!0);f.uN.rb(f.yD);Hh(f.yD,"describedby",k.ywa);this.R.Ia(f.uN);c.appendChild(d,f.yD);this.Hc.V(f.uN,"action",function(a){return function(){iSd(b,
a.uN,a.KD,a.D0,a.We)}}(f)).V(f.yD,"mouseenter",function(a){return function(){PT(b.od,Tw(a.kf))}}(f)).V(f.yD,"mouseleave",function(){QT(b.od)}).V(f.yD,"focus",function(a){return function(){pi(a.yD,d)}}(f))}};function iSd(a,b,c,d,e){var f=bSd,h=Nh(b.$a(),f.Bea);a.R.nf(function(a){a.jk(f.Bea,!1);a.yc(!1)});b.jk(f.Bea,!h);b.yc(!h);a.Sb=!0;h?(a.show(!0),a.L=null,a.sb=null,a.Ob=-1):(b=new Fv,X(b,1,c),$Rd(a.F,b,null,null,!0),URd(a.F),a.C.eb(d),a.L=c,a.sb=d,a.Ob=e);a.Sb=!1}
p.BZb=function(a){if("save"==a.key){if(!jSd(this)){a.preventDefault();return}}else if("clear"==a.key&&!kSd(this)){a.preventDefault();return}this.C&&this.C.Pa(!1)};function gSd(a){var b=lSd(a.ul);b&&a.J.setContent(b);a.J.setVisible(0!=a.ul);b=2==a.ul||4==a.ul;var c=bSd,d=a.va().Sw(a.C.getElement());Rh(d,c.hva,b);b&&a.C.Gr().select()}
function lSd(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function mSd(a){var b=a.F,c=G2(b);if(0==c){c=b.L;var d=b.qa,e=VRd(b,c),f=VRd(b,d);e&&f?b.D.ul=0:(e||F2(c),f||F2(d),b.D.ul=1)}else if(1==c)c=b.O,d=b.Aa,e=!Ai(c)||!Lb($b(c.value)),f=!Ai(d)||!Lb($b(d.value)),e&&f?b.D.ul=0:(e||F2(c),f||F2(d),b.D.ul=6);else if(2==c)c=b.H,d=b.R,e=!Ai(c)||!Lb($b(c.value)),f=!Ai(d)||!Lb($b(d.value)),e&&f?b.D.ul=0:(e||F2(c),f||F2(d),b.D.ul=7);else if(3==c||4==c)c=0,4==G2(b)?(d=ZRd(b),FR(b.$b,d)?(d=ZRd(b),d=GR(b.$b,d),e=H2(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==G2(b)&&b.C.getElement()&&Lb($b(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.ul=d,d=b.Fb&&Ai(b.Fb),b.mb&&Ai(b.mb)?(Rh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.va().Sw(b.La.getElement()),Rh(d,"waffle-input-error",!c),b.La.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Oa.isChecked()){c=b.Na;e=b.fb;d=Ob($b(c.value));e=Ob($b(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==
e.toLowerCase();var h=ic(d)==ic(e);f=d==e||h||f;Lb(d)?(F2(c),b.D.ul=8):f?b.D.ul=9:kC(d)||kC(e)?b.D.ul=10:b.D.ul=0}}else b.D.ul=0;b=a.C.getValue();b=FR(a.O,b);2==a.ul&&b?a.ul=0:0!=a.ul||b||(a.ul=2);gSd(a);return 0!=a.ul}
function jSd(a){if(mSd(a))return!1;var b=a.F,c=b.Ob.isChecked("rejectInvalidData_radio"),d=QRd(b);b.jb.isChecked()||(d="");var e=YRd(b);if(!e)return!1;var f=new rx;X(f,1,e);X(f,2,d);X(f,3,c);zBc(f,Ai(b.Sb)&&b.Bb.isChecked());b=nSd(a);if(!b)return!1;c=new Lg;e=Gv(e);d=a.L&&Cv(a.L)==Cv(e);var h=Dv(e);if(d){var k=oSd(a,jRd(a.O,a.sb)),l=pSd(a);k=Vw(k,b);G(c,12,!l||!k);var m=new mRd;G(m,1,!k);G(m,2,!l);G(m,3,a.Ob);OO(c,17,Yfa[0],m)}else{for(var r=m=k=l=!1,u=!1,w=0;w<a.$b.length;w++){var y=oSd(a,jRd(a.O,
a.$b[w]));if(y){var B=Vw(y,b);y=XZa(y,b);var J=a.rc[w],R=Cv(J)==Cv(e);J=Dv(J);J=yb(J,h,function(a,b){return a.equals(b)});u|=J;l|=B&&R&&J;k|=B;m|=B&&R;r|=y}}w=new nRd;G(w,1,l);G(w,2,k);G(w,3,m);G(w,4,r);G(w,5,u);OO(c,18,Yfa[0],w)}qBc(c,kLc(Cv(e)));l=ia(a.rc);for(k=l.next();!k.done;k=l.next())hRd(c,kLc(Cv(k.value)));l=Fa()-a.Dd;G(c,14,l);l=new Jg;eg(l,58,c);c=Sj(Tj(new Rj,l),1).build();a.Hb.Zb(d?35578:35301,c);31==Cv(e)&&a.Hb.Zb(0<h.length?35604:35603,c);a.ue.C(new PLc(f,b));return!0}
function pSd(a){var b=YRd(a.F);if(!b||!a.L)return!1;b=Dv(Gv(b));a=Dv(a.L);return yb(a,b,function(a,b){return a.Go().getValue().equals(b.Go().getValue())})}
function kSd(a){var b=nSd(a);if(!b)return!1;try{if(!YRd(a.F))return a.Hb.Zb(35300),!0;var c=Gv(YRd(a.F)),d=a.L&&Cv(a.L)==Cv(c),e=!1,f=new Lg;if(d){var h=fmb(BD(a.Bb).np().Mc(),jRd(a.O,a.C.getValue()));mk(h,function(a){PE(a)&&(e=!0);return e});if(!e){var k=new nRd;G(k,6,!0);OO(f,18,Yfa[0],k)}}var l=new Jg;eg(l,58,f);var m=Sj(Tj(new Rj,l),1).build();a.Hb.Zb(35300,m);return!0}finally{a.ue.C(new PLc(new rx,b))}}function nSd(a){var b=jRd(a.O,a.C.getValue());return oSd(a,b)}
function oSd(a,b){var c=a.C.getValue();a=(a=GR(a.O,c))?a.C:null;return b&&null!=a?Qw(b,a):null}function H2(a){var b=a.C.getValue();return GR(a.O,b)}function IRd(a,b){var c=a.Jb.C.pe();a=new oT(a.Bb,v(a.yZb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.va());a.render(b);return a}p.setVisible=function(a){aSd.oa.setVisible.call(this,a);a&&this.Fb&&(this.Fb.focus(),this.Fb=null)};p.yZb=function(a,b,c,d){this.Fb=a.Gr();this.Qe.nca(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=UH(this.Jb),e=PE(pF(d,vF(d)));d=null;var f=!1;e&&(e=e.by,d=W(e,1),b=W(e,2),c=W(e,3),f=W(e,4));$Rd(this.F,d,b,c,f);(b=YRd(this.F))&&Gv(b);this.setVisible(!0);this.C&&this.C.Pa(!0);dSd(this);URd(this.F);fSd(this,a);this.Dd=Fa()};
function fSd(a,b){a.fb&&!b&&(KBc(a.jb)?(MT(a.Oa,!0),M(a.mb.$a(),!0),a.R.Fd(!0),a.Hc.Qc(),FBc(a.jb),b=H2(a),null==b||Aw(b.rect)||b.rect.equals(a.Ge)?wCc(a.jb,!0,!1,[6]):vCc(a.jb,!0,!1,!1,[6],[H2(a).rect])):(MT(a.Oa,!1),M(a.mb.$a(),!1),hSd(a)))}p.Ha=function(){C(this.F);this.F=null;C(this.C);this.Aa=this.Ea=this.C=null;C(this.J);aSd.oa.Ha.call(this)};function qSd(a,b,c,d,e){Tp.call(this);this.jb=c;this.sb=d.C;this.fb=d;this.$b=e;this.mb=null;this.Jb=d.ma;Up(this,"Find and replace");aq(this,!1);c=this.Pb();d=Td(c);this.C=d.Da("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Oa=d.Da("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new XL(null);this.Ba(this.F);this.Hc=b;this.O=new oT(this.jb,v(this.EZb,this),!1,"",!0);this.Ba(this.O);this.Aa=null;this.R=new $s;this.Ba(this.R);this.Ea=new $s;this.Ba(this.Ea);
this.L=new $s;this.Ba(this.L);this.J=new $s;this.Ba(this.J);this.Sb=this.Fb=this.Hb=this.Ob=!1;this.Bb=d.Da("SPAN");IDc(this.Bb);this.rc=new Ar(this.C);this.Ba(this.rc);a=rSd;d.Da("LABEL",{"for":a.Sua},"Search");b=d.Da("LABEL",{"for":a.Fva},"Match case");e=d.Da("LABEL",{"for":a.Gva},"Match entire cell contents");var f=d.Da("LABEL",{},"Also search within formulas"),h=d.Da("LABEL",{"for":a.jwa},"Search using regular expressions "),k=(new Gl(I4a)).toString(),l=d.Da("SPAN",null,d.Da("A",{target:"_blank",
href:k},"Help"));this.getHandler().V(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});k=Mi(this,"findLabel");var m=Mi(this,"replaceLabel"),r=Mi(this,"findScopeLabel"),u=d.Da("DIV","goog-inline-block"),w=d.Da("DIV",a.v0a);l=d.Da("TABLE",null,d.Da("TBODY",null,d.Da("TR",null,d.Da("TD",a.LABEL,d.Da("LABEL",{id:k},"Find")),d.Da("TD",null,this.C)),d.Da("TR",null,d.Da("TD",a.LABEL,d.Da("LABEL",{id:m},"Replace with")),d.Da("TD",null,this.Oa)),d.Da("TR",null,d.Da("TD",null,d.Da("LABEL",
{id:r},"Search")),d.Da("TD",null,u,w)),d.Da("TR",null,d.Da("TD",null,""),d.Da("TD",null,b,d.Da("BR"),e,d.Da("BR"),h,l,d.Da("BR"),f)),d.Da("TR",null,d.Da("TD",{colspan:"2"},this.Bb))));this.F.render(u);L(this.F.getElement(),a.Sua);this.O.render(w);Li(this.R,b);Ys(this.R,b);this.R.getElement().id=a.Fva;Li(this.Ea,e);Ys(this.Ea,e);this.Ea.getElement().id=a.Gva;Li(this.L,h);Ys(this.L,h);this.L.getElement().id=a.jwa;Ys(this.J,f);Li(this.J,f);Hh(this.C,"labelledby",k);Hh(this.Oa,"labelledby",m);Hh(this.F.$a(),
"labelledby",r);d.appendChild(c,l);c=new bq;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);eq(this,c);pq(this,"");this.getHandler().V(this,"dialogselect",this.FZb).V(this.rc,"input",this.yna).V(this.L,"change",this.gBb).V(this.F,"change",this.crb).V(this.O,"change",this.GZb).V(this.J,"change",this.hBb);c=new Br;c.rb(this.C);this.Ba(c);c=new Br;c.rb(this.Oa);this.Ba(c);sSd(this);c=new Rp(this.getElement());this.Ba(c);this.getHandler().V(c,
"focusin",this.AUa).V(this.getElement(),"mousedown",this.AUa)}x(qSd,Tp);var rSd={iua:"waffle-find-replace-dialog-border",Sua:"waffle-find-replace-find-scope-select",hva:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",Fva:"find-replace-case",Gva:"find-replace-cell",jwa:"find-replace-regex",v0a:"waffle-find-replace-selection-input goog-inline-block"};
function sSd(a){var b=BD(a.jb),c=null,d=null;b&&(c=RTb(b),d=OF(a.sb,c.C).pe());a.J.Bc(a.Jb);var e=new Rk("All sheets",Mcb.AVa),f=new Rk("This sheet",Mcb.E0a),h=new Rk("Specific range",Mcb.nE);a.F.Ad(e);a.F.Ad(f);a.F.Ad(h);f=c?AG(a.sb,c.C):null;f=(f=c&&f?eF(f,c.rect.Cc(),c.rect.Ac()):null)?f.kh():1;c&&c.rect.kh()>f?ir(a.F,h):ir(a.F,e);b&&a.O.eb($F(c.rect,d))}function tSd(a){var b=a.F.Ve().kb(),c=QF(a.jb.C);return 0==b?YF(a.O.getValue(),a.sb,!1,!0):1!=b||null===c?null:new Mw(c,new sw(0,0,1,1))}p=qSd.prototype;
p.AUa=function(a){a.target==this.getElement()?this.focus():this.$b.Rb(2)};p.GZb=function(){uSd(this)};p.hBb=function(){var a=this.J.isChecked();agc(this.fb,a)};p.crb=function(){uSd(this)};p.gBb=function(){this.L.isChecked()&&this.R.Bc(!0);this.yna()};
p.FZb=function(a){var b=vSd;if("findNext"==a.key)a.preventDefault(),this.Ob&&(K2(this,null),wSd(this,b.Rua));else if("replace"==a.key)a.preventDefault(),this.Hb&&(K2(this,null),wSd(this,b.Zva));else if("replaceAll"==a.key&&(a.preventDefault(),this.Sb)){a=v(function(){K2(this,null);wSd(this,b.Yva)},this);var c=this.F.Ve().kb();1<this.sb.D.length&&2==c&&!this.Fb?(cBc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Fb=!0):a()}};
p.yna=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;fq(this.D,"findNext").disabled=!a;this.Ob=a;xSd(this,a);this.Hb&&!a&&ySd(this,!1);Rh(this.C,"waffle-input-error",b)};p.EZb=function(a,b,c){this.mb=a.Gr();this.Hc.nca(this,a,b,c,!1,!0)};
function uSd(a){var b=0==a.F.Ve().kb();a.O.setVisible(b);C(a.Aa);a.Aa=null;var c=tSd(a),d=BD(a.jb);b&&d&&c&&(a.Aa=kL(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.Aa.setVisible(!0),a.Ba(a.Aa))}function wSd(a,b){if(0==a.F.Ve().kb()&&null==tSd(a))Rh(a.O.D,"waffle-range-selection-error",!0),K2(a,"Invalid range");else{var c=a.F.Ve().kb();a.dispatchEvent(new zSd(b,a.C.value,a.Oa.value,c,a.R.isChecked(),a.Ea.isChecked(),a.L.isChecked(),a.J.isChecked(),tSd(a)))}}
p.setVisible=function(a){var b=this.fb.Rd();xSd(this,!b);ySd(this,!b);this.Oa.disabled=b;qSd.oa.setVisible.call(this,a);a&&this.mb&&(this.mb.focus(),this.mb=null)};p.ITb=function(a){this.C.value=a};p.$Qa=function(){this.C.select()};p.focus=function(){this.Qb()&&this.isVisible()&&(this.C.focus(),this.$b.Rb(2),Vr(this.C,this.C.value.length),this.yna())};function ySd(a,b,c){b=b&&!a.fb.Rd()&&0==!a.C.value.length;a.Hb=b;a=fq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function xSd(a,b){b=b&&!a.fb.Rd()&&0==!a.C.value.length;a.Sb=b;fq(a.D,"replaceAll").disabled=!b}function K2(a,b){var c=Td(a.Pb());a=a.Bb;b?(0<se(a).length&&c.appendChild(a,c.Da("BR")),c.appendChild(a,c.Da("B",null,Le(c,b)))):c.Fd(a)}p.Ha=function(){qSd.oa.Ha.call(this);this.Fb=!1;agc(this.fb,this.Jb)};function zSd(a,b,c,d,e,f,h,k,l){D.call(this,a);this.D=b;this.F=c;this.C=d;this.O=e;this.R=f;this.ma=h;this.Ga=k;this.La=l||null}x(zSd,D);
var vSd={Rua:"findnext",Nec:"findall",Zva:"replace",Yva:"replaceall",DONE:"done",X5b:"canceled"};function ASd(a,b,c,d,e){A.call(this);var f=vSd;this.F=null;this.C=a;this.D=b;this.H=c;this.O=d;this.L=e;this.J=new Uh(this);this.Ba(this.J);this.J.V(a,f.Yva,this.jAb).V(a,f.Zva,this.kAb).V(a,f.Rua,this.zUa).V(a,f.DONE,this.kpb)}x(ASd,A);var L2={WN:"cg",XN:"cr",UN:"cc",Qua:"loop"};p=ASd.prototype;p.FVb=function(){this.C.setVisible(!0);BSd(this,null)};p.zUa=function(a){if(CD(this.D.C)){var b=BD(this.D).kb(),c=this.F;c||(c=vF(b),c=Gc(L2.WN,b.Ec(),L2.XN,b.O.C[c.y],L2.UN,b.ye.C[c.x]));CSd(this,a,b,c)}};
function CSd(a,b,c,d){var e=new $u,f=DSd(b);ESd(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.Bd((new Pcb).Ca(),a);a=W(f,1);var d=b.type;CD(this.D.C)&&(c?Su(c,1)?(d=W(c,1),c=Gc(L2.WN,d.Ib(),L2.XN,d.jq(),L2.UN,d.getColumnIndex(),L2.Qua,W(c,2)),FSd(this,a,c)):(FSd(this,a,{}),"replace"==d&&this.C.focus()):GSd(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function ESd(a,b,c){if(c){var d=c[L2.WN],e=new kw;X(e,1,d);X(e,2,iRd(b,c[L2.XN],"r"));X(e,3,iRd(b,c[L2.UN],"c"));X(a,10,e)}}
function DSd(a){var b=new pC;X(b,1,a.D);X(b,3,a.F);X(b,5,a.C);if(0==a.C||1==a.C){var c=a.La,d=new ov;X(d,1,c.C);var e=c.rect.Cc();X(d,2,e);pv(d,c.rect.cd());d.Br(c.rect.Ac());d.Qx(c.rect.hd());b.setSelection(d)}X(b,6,a.O||!1);X(b,7,a.R||!1);X(b,8,a.ma||!1);b.setType(a.Ga?1:0);X(b,11,0);return b}function FSd(a,b,c){c?c&&null!=c.cg?(b=c[L2.WN],c[L2.Qua]&&K2(a.C,"No more results found, looping around"),a.H.wA(b,v(a.DZb,a,c))):(BSd(a,null),K2(a.C,"There are no entries matching "+b)):GSd(a)}
p.DZb=function(a){var b=BD(this.D).kb(),c=a[L2.XN],d=a[L2.UN];a[L2.XN]=b.O.C[c];a[L2.UN]=b.ye.C[d];BSd(this,a);a=new Md(d,c);b=new Mw(b.Ec(),vw(a));HR(this.H,b,v(this.d3a,this,a))};
p.d3a=function(a){if(!this.isDisposed()){this.C.focus();var b=BD(this.D).kb();NE(b.ih(a.y,a.x))&&!this.C.J.isChecked()&&ySd(this.C,!1,"Can't replace formula");var c=gF(b,a.y),d=hF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=ZF(a),a=ME(pF(b,a)),K2(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function GSd(a){K2(a.C,null);K2(a.C,"Error while searching spreadsheet. Please try again.")}
p.kAb=function(a){if(!this.L.Rd()){var b=this.F;if(b){var c=IE(this.H,b[L2.WN]);if(c){var d=c.Mc(),e=iRd(d,b[L2.XN],"r"),f=iRd(d,b[L2.UN],"c");c=d.ih(e,f);if(!NE(c)||this.C.J.isChecked()){c=ME(c);var h=new $u,k=DSd(a);X(k,5,0);ESd(k,d,b);d=new ov;X(d,1,b[L2.WN]);X(d,2,e);pv(d,e+1);d.Br(f);d.Qx(f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);HSd(this,k,c,b,!1);this.zUa(a)}}}}};p.jAb=function(a){if(!this.L.Rd()&&CD(this.D.C)){var b=DSd(a);HSd(this,b,a.D,a.F,!0)}};
function HSd(a,b,c,d,e){b=new ZMc(b);vD(b,v(function(a,b){a?(a=W(b,5),b=W(b,4),b=0==a?"No matches found":e?(new ys(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),K2(this.C,null),K2(this.C,b)):GSd(this)},a));K2(a.C,null);K2(a.C,"Working...");a.O.C(b)}p.kpb=function(){BSd(this,null)};function BSd(a,b){a.F=b;(a=a.C)&&ySd(a,null!=b)};function ISd(a,b,c){lRd.call(this);Up(this,"Grouping rule");this.Aa=a;this.Oa=b;this.Ea=c;this.R=new N;this.Ia(this.R,!0);this.F=new JSd("Minimum value","e.g. 0",!0);this.R.Ia(this.F,!0);this.L=new JSd("Maximum value","e.g. 100",!0);this.R.Ia(this.L,!0);this.J=new JSd("Interval size","e.g. 10",!1);this.Ia(this.J,!0);(a=this.Aa.C.getActiveGrid())&&(a=JF(a.Mc()))&&(a=KSd(this,a))&&Su(a,10)&&Su(Ix(a),3)&&(a=W(Ix(a),3),Su(a,1)&&(b=W(a,1),this.F.D.eb(lU.format(b))),Su(a,2)&&(b=W(a,2),this.J.D.eb(lU.format(b))),
Su(a,3)&&(a=W(a,3),this.L.D.eb(lU.format(a))))}q(ISd,lRd);
ISd.prototype.k8=function(){var a=LSd(this.F),b=LSd(this.J),c=LSd(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(MSd(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(MSd(this.F,"Value too large"),d=!1):d=!0;if(d){d=new Jx;d.setType(2);var e=new Mx;null!=a&&X(e,1,a);null!=b&&X(e,2,b);null!=c&&X(e,3,c);X(d,3,e);if(a=this.Aa.C.getActiveGrid())if(a=a.Mc(),b=JF(a))if(c=KSd(this,b))X(c,10,d),this.Oa.C(new CM(b,a)),Lz("Pivot table headings grouped.");lRd.prototype.k8.call(this)}};
function KSd(a,b){b=Lkb(b,function(b){return b.pY()==a.Ea});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return Su(b[0],10)?b[0]:b[1]}function JSd(a,b,c,d){N.call(this,d);this.L=a;this.O=b;this.R=c;this.J=new N;this.Ia(this.J,!0);this.D=new ET;this.Ia(this.D,!0);this.H=null;this.C=new N;this.Ia(this.C,!0);this.F=new dS(this.va(),!0,!0);this.Ba(this.F)}q(JSd,N);
JSd.prototype.Ja=function(){N.prototype.Ja.call(this);this.$a().className="waffle-pivot-histogram-errorable-input";this.J.$a().className="waffle-pivot-histogram-dialog-caption";this.va().Se(this.J.getElement(),this.L);this.H=this.D.Td().cM(this.D.$a());this.H.placeholder=this.O;Lh(this.H,this.L+" - "+this.O);gS(this.F,this.H);this.C.$a().className="waffle-pivot-histogram-dialog-error";Gh(this.C.$a(),"alert");Hh(this.C.$a(),"live","polite");NSd(this)};
function LSd(a){NSd(a);var b=a.D.getValue();if(Lb(b)){if(a.R)return null;MSd(a,"Required");return NaN}b=lU.parse(b);isNaN(b)&&MSd(a,"Must be a number");return b}function MSd(a,b){a.C.$a().style.visibility="";a.va().Se(a.C.$a(),b);eS(a.F,b,!1)}function NSd(a){a.C.$a().style.visibility="hidden";fS(a.F)};function OSd(a){a=a||{};var b=a.type;return Q('<input class="'+S("jfk-textinput")+(a.Jd?" "+S(a.Jd):"")+'"'+(a.id?' id="'+S(a.id)+'"':"")+(a.maxLength?' maxlength="'+S(a.maxLength)+'"':"")+(a.X$&&a.eXb?' label="'+S(a.X$)+'"':"")+(a.name?' name="'+S(a.name)+'"':"")+(a.X$?' placeholder="'+S(a.X$)+'"':"")+' type="'+S(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+S(a.pattern)+'"':"")+(a.value?' value="'+S(a.value)+'"':"")+(a.dir?' dir="'+S(a.dir)+'"':"")+(a.attributes?" "+nEa(a.attributes):"")+">")};function PSd(a){a=""+QSd({id:"waffle-resize-selection-custom",nLa:a.Eha,Xk:Eq("<br/>"+P(OSd({id:"waffle-resize-input",Jd:"waffle-resize-inset-input"})))});a+=QSd({id:"waffle-resize-selection-auto",nLa:Dq("Fit to data"),Xk:Eq("")});return Q(a)}function QSd(a){return Q('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+S(a.id)+'"><label for="'+S(a.id)+'" class="waffle-resize-label">'+P(a.nLa)+"</label>"+P(a.Xk)+"</div>")}
function RSd(a){var b=a.odb;a='<label for="waffle-resize-input">'+P(a.Eha)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return Q(a)};function SSd(a,b,c,d,e){Tp.call(this);this.L=a;this.Ea=b;var f=Ew(this.L.Rc());this.C=f;this.F=Va(rF(this.L),function(a){return Ew(a)==f});this.J=new wP;this.O=new VMc(!0);this.R=new $s;this.Oa=c;this.fb=d;this.Aa=e}x(SSd,Tp);var TSd={AUTO:"waffle-resize-selection-auto",Wo:"waffle-resize-selection-custom",gva:"waffle-resize-input",j_a:"waffle-resize-selection",m0a:"waffle-resize-rows-can-grow-checkbox"};p=SSd.prototype;
p.Da=function(){SSd.oa.Da.call(this);var a=this.F[0];if("r"==this.C){var b=a.Cc();a=a.cd()-1;var c=String(TF(b+1)),d=String(TF(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.Ac(),a=a.hd()-1,c=VF(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+VF(a)));Up(this,b);"r"==this.C?this.Pb().appendChild(O(RSd,{Eha:USd(this),odb:I(H(),"fefrh")})):this.Pb().appendChild(O(PSd,{Eha:USd(this)}));pq(this,
"ok")};p.Ja=function(){SSd.oa.Ja.call(this);var a=this.va(),b="r"==this.C;this.J.rb(a.getElement(TSd.gva));I(H(),"fefrh")&&b&&(a=a.getElement(TSd.m0a),Ys(this.R,a),Li(this.R,a));a=this.L.Rc();var c=Ew(a);a=Agb(emb(this.L,c,Cw(a,c)));this.J.eb(String(a));b||(WMc(this.O,TSd.j_a),XMc(this.O,TSd.Wo));this.getHandler().V(this,"dialogselect",this.LZb).V(this.J.getElement(),"focus",this.hFb)};p.hFb=function(){"c"==this.C&&XMc(this.O,TSd.Wo)};p.focus=function(){this.Qb()&&AP(this.J)};
function USd(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(TE+")"):"Enter new column width in pixels. (Default: "+(Cgb+")")}
p.LZb=function(a){if("ok"==a.key)if((a="r"==this.C)||YMc(this.O)==TSd.Wo){var b=parseInt(this.J.getValue(),10);isNaN(b)?Kz("Entered value is not a number."):2>b||2E3<b?Kz("Size must be between 2 and 2000 pixels."):(this.Aa.C("r"==this.C?35310:35308),b=new MM(this.L,this.F[0],b,this.F.slice(1)),I(H(),"fefrh")&&a&&(a=!this.R.isChecked(),b.L=a),this.Ea.C(b))}else BD(this.Oa),this.Aa.C(35307),GYb(this.F,this.fb,this.Ea)};function VSd(a){Wf(this,a,0,-1,null,null)}x(VSd,Vf);VSd.prototype.getType=function(){return F(this,3)};VSd.prototype.setType=function(a){G(this,3,a)};function WSd(a){N.call(this,a);this.ma=yz("email");this.C=this.D=null}x(WSd,N);p=WSd.prototype;
p.Da=function(){var a=this.va();var b=this.va();this.C=new XS;this.Ba(this.C);this.D=new XS;this.Ba(this.D);var c=b.Da("DIV","waffle-dialog-notifications-input");Gh(c,"presentation");this.F=new VS;WS(this.F,b.Da("LABEL",null,"Any changes are made"));this.F.render(c);this.C.aH(this.F);var d=b.Da("DIV","waffle-dialog-notifications-input");Gh(d,"presentation");this.J=new VS;WS(this.J,b.Da("LABEL",null,"A user submits a form"));this.J.render(d);this.C.aH(this.J);var e=b.Da("DIV","waffle-dialog-notifications-input");
Gh(e,"presentation");this.H=new VS;WS(this.H,b.Da("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.aH(this.H);var f=b.Da("DIV","waffle-dialog-notifications-input");Gh(f,"presentation");this.L=new VS;WS(this.L,b.Da("LABEL",null,"Email - right away"));this.L.render(f);this.D.aH(this.L);b=b.Da("DIV",null,b.Da("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.ma+" when...")),b.Da("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.ma+" when...")},c,d),b.Da("DIV",
{style:"padding: 5px"}),b.Da("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Da("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.va();d=c.Da("DIV");this.O=fP("Save",c);this.Ia(this.O,!1);this.O.render(d);this.R=new Rq("Cancel",c);this.Ia(this.R,!1);this.R.render(d);a=a.Da("DIV","waffle-dialog-notifications",a.Da("DIV",null,b),a.Da("DIV",null,d));this.Lb(a)};
p.Ja=function(){WSd.oa.Ja.call(this);this.getHandler().V(this.O,"action",this.PSb,!0).V(this.R,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).V(this.C,"change",this.zta).V(this.D,"change",this.zta)};p.Jc=function(a){WSd.oa.Jc.call(this,a);a?1==a.getType()?YS(this.C,this.F):2==a.getType()&&YS(this.C,this.J):YS(this.C,null);a?2==F(a,2)?YS(this.D,this.H):1==F(a,2)&&YS(this.D,this.L):YS(this.D,null);this.zta()};p.focus=function(){var a=ZS(this.C),b=this.C.C.Ue(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&M(this.getElement(),a)};p.PSb=function(){this.dispatchEvent(new D("saveRule",XSd(this)))};function XSd(a){var b=new VSd,c=a.kb();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.zta=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Pa(a)};function YSd(a){return Q("<div><div>"+P(a.x5a)+"</div>"+P(Zs({id:"waffle-confirm-suppress-checkbox",Jd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+P(a.Asa)+"</span></div>")};function ZSd(a,b,c,d,e,f,h){if(za(c)){var k=new bq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=tDa;return $Sd(d||"Heads up!",a,b,k,e,f,h)}function $Sd(a,b,c,d,e,f,h){b=td(b);if(f){b=tq(YSd({x5a:b,Asa:f}));var k=new $s;var l=c;c=function(){l(k.isChecked())}}a=JDa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ia(k),k.rb(He(a.va(),"waffle-confirm-suppress-checkbox")),c=He(a.va(),"waffle-confirm-suppress-label"),Ys(k,c),k.Bc(!1));return a};function M2(a,b){N.call(this,b);this.Jc(a)}x(M2,N);
M2.prototype.Da=function(){var a=this.kb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.va();a=d.Da("TD",null);b=d.Da("TD",{width:"50px"});c=d.Da("TR",{valign:"center"},d.Da("TD",null,d.Da("SPAN","waffle-notification-rule",c)),d.Da("TD",{align:"right"},d.Da("TABLE",null,d.Da("TBODY",null,d.Da("TR",null,a,b)))));d=Ri(xq,"waffle-notifications-add");this.D=new yq("Edit",
d,this.va());this.D.Id("goog-link-button");this.D.Id("menuMainLink");this.Ia(this.D,!1);this.D.render(a);this.C=new yq("Delete",d,this.va());this.C.Id("goog-link-button");this.C.Id("menuMainLink");this.Ia(this.C,!1);this.C.render(b);this.Lb(c)};M2.prototype.Ja=function(){M2.oa.Ja.call(this);this.getHandler().V(this.D,"action",this.H);this.getHandler().V(this.C,"action",this.F)};M2.prototype.H=function(){this.dispatchEvent(new D("edit",this.kb()))};
M2.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.kb()))},this),b=v(function(){this.C.getElement().focus()},this);ZSd("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function aTd(a){N.call(this,a);this.C=null}x(aTd,N);aTd.prototype.Da=function(){var a=this.va();this.C=a.Da("TBODY");a=a.Da("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C);this.Lb(a)};aTd.prototype.Pb=g("C");aTd.prototype.setVisible=function(a){this.getElement()&&M(this.getElement(),a)};function bTd(a,b,c){Tp.call(this);this.L=b;Up(this,"Set notification rules");aq(this,!1);a=new bq;a.set("cancel","Done",!1,!0);eq(this,a);this.C=new WSd(c);this.Ia(this.C,!1);this.F=new aTd;this.Ia(this.F,!1);this.J=new yq("Add another notification rule",CN.getInstance(),this.va());this.Ia(this.J,!1)}x(bTd,Tp);p=bTd.prototype;
p.Da=function(){bTd.oa.Da.call(this);var a=this.va(),b=kvb(new Gl(F4a+"91588")).toString();b=a.Da("A",{target:"_blank",href:b},"Help");var c=a.Da("DIV");this.J.render(c);this.R=a.Da("DIV");this.O=a.Da("DIV");var d=a.Da("DIV","waffle-dialog-notifications-bounds",this.R,this.O);b=a.Da("DIV",null,a.Da("DIV",{align:"right"},b),d,c);a.appendChild(this.Pb(),b);pq(this,"")};
p.Ja=function(){bTd.oa.Ja.call(this);this.F.render(this.R);this.C.render(this.O);this.getHandler().V(this,"edit",this.OZb).V(this,"del",this.NZb).V(this.J,"action",this.MZb).V(this,"saveRule",this.OSb).V(this,"cancelRuleEdit",this.H4a)};p.P_=function(a){this.isDisposed()||(this.C.setVisible(!1),cTd(this,!1),nz(this.L,"/notifications/list",v(this.NWb,this,a)).He())};
p.NWb=function(a,b,c){if(!this.isDisposed()){b=c.hf();c=[];for(var d=0;d<b.length;d++)c[d]=new VSd(b[d]);this.Jc(c);if(a&&0==c.length)dTd(this,null,!1);else{if(a=this.kb())if(b=this.F,b.Fd(!0),b.va().Fd(b.Pb()),b.Jc(a),c=b.va(),0==a.length)c.appendChild(b.Pb(),c.Da("TR",null,c.Da("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ia(new M2(a[d],c),!0);cTd(this,!0);this.focus()}}};
p.OSb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?bt(nz(this.L,"/notifications/set",v(this.P_,this,!1)),{rule:b}).He():bt(nz(this.L,"/notifications/create",v(this.P_,this,!1)),{rule:b}).He()};p.H4a=function(){this.C.setVisible(!1);this.P_(!1)};p.OZb=function(a){dTd(this,a?a.target:null,!0)};p.MZb=function(){dTd(this,null,!0)};function dTd(a,b,c){cTd(a,!1);var d=a.C;d.Jc(b);d.setVisible(!0);c&&a.C.focus()}
p.NZb=function(a){this.F.setVisible(!1);a=a.target;bt(nz(this.L,"/notifications/delete",v(this.P_,this,!1)),{rule_id:F(a,1)}).He()};function cTd(a,b){a.F.setVisible(b);var c=Yp(a);M(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.P_(!0)};function eTd(a,b,c,d,e){uD.call(this,68);this.O=a;this.L=b;this.D=c;this.H=d;this.C=e}x(eTd,uD);eTd.prototype.Xd=function(){var a=new bD;this.O&&X(a,1,this.O);t(this.L)&&X(a,2,this.L);t(this.D)&&X(a,3,this.D);this.H&&X(a,4,this.H);t(this.C)&&X(a,5,this.C);return a};eTd.prototype.p_=function(a,b){(t(this.D)||t(this.H)||t(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);eTd.oa.p_.call(this,a,b)};function fTd(a,b,c){b=c||b;c='<tr class="dialog-settings-general-settings-div"><div>';var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(P(a.D6a)+"</a>");c=c+d+"</div>";a.EUb&&(c+='<div class="dialog-settings-english-name-div">'+P(Zs({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
c+="Always use English function names</label></div>");return Q(c+"</tr>")}function gTd(){return Q('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function N2(a,b,c,d){Tp.call(this);this.Ob=a;this.Vc=b;this.R=c;this.rc=d;this.C={};this.Hb=this.sb=!1;this.$b=this.Jb=this.Fb="";this.Hc=new $u;this.J=[];this.F=this.Hc.Bd((new dw).Ca(),ritz_api.RitzModelApi.getWorkbookProperties());Up(this,"Settings for this spreadsheet");this.mb=!1;this.fb=new $s;this.Ia(this.fb);this.O=new dS;this.Ia(this.O);this.L=new dS;this.Ia(this.L);this.Bb=new tS;this.Ia(this.Bb);this.Oa=this.jb=null;this.Sb=new ws(1);this.Aa=this.Ea="";this.C[0]=D2();this.C[1]=D2();this.C[2]=
D2();this.C[3]=D2();this.C[4]=new wP;this.C[5]=new wP}x(N2,Tp);var hTd=null,iTd={k3:0,K1a:1,HVa:2,WYa:3,qZa:4,JWa:5},jTd={p2a:"waffle-settings-dialog-english-name-checkbox",q2a:"waffle-settings-dialog-english-name-checkbox-label"},kTd=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],lTd=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=N2.prototype;
p.Da=function(){N2.oa.Da.call(this);var a=this.Pb(),b=this.va(),c=[mTd(b,"Locale","waffle-settings-label-locale"),nTd(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),oTd(this),mTd(b,"Time zone","waffle-settings-label-timezone"),nTd(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
oTd(this)],d=[];d.push(mTd(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(nTd(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(oTd(this));d.push(mTd(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=kvb(new Gl(F4a+"58515")).toString();e=b.Da("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(nTd(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=mTd(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=nTd(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");pTd(e);d.push(e);this.J.push(e);e=mTd(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=nTd(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");pTd(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Ve().getValue()&&qTd(this);d.push(oTd(this));c=nb(c,d);c.push(O(fTd,{D6a:this.Jb,EUb:this.mb}));this.jb=b.Da("TABLE","dialog-settings",b.Da("TBODY",null,c));this.Oa=b.Da("table","dialog-settings",b.Da("tbody",null,d));c=O(gTd);b.appendChild(a,c);this.Bb.rb(c);
b.appendChild(a,this.jb);b.appendChild(a,this.Oa);M(this.Oa,!1);hTd||(a=new bq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),hTd=a);eq(this,hTd);rTd(this,4,Su(this.F,3)&&W(this.F,3).O8()?W(this.F,3).C6().toString():"50");rTd(this,5,Su(this.F,3)&&W(this.F,3).M8()?W(this.F,3).p6().toString():"0.05");pq(this,"save")};function pTd(a){a=a.firstChild.firstChild;L(a,"jfk-textinput");ci(a,"width","7em")}function qTd(a){for(var b=0;b<a.J.length;b++)M(a.J[b],!1)}
function mTd(a,b,c){return a.Da("TR",null,a.Da("TD",{id:c,"class":"dialog-settings-label"},b))}function nTd(a,b,c,d,e,f,h){b=b.Da("TR",null,b.Da("TD","dialog-settings-input"),b.Da("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.$a();Hh(a,"labelledby",e);Hh(a,"describedby",f);return b}function oTd(a){a=a.va();return a.Da("TR",null,a.Da("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Da("HR",{"class":"dialog-settings-sep"})))}
p.Ja=function(){N2.oa.Ja.call(this);mf(this,"dialogselect",v(this.PZb,this));this.getHandler().V(this.C[3],"action",this.TUb);this.getHandler().V(this.Bb,"select",this.LDb);var a=this.C[4].getElement();this.O.hj(a);gS(this.O,a,a);this.O.render();fS(this.O);this.getHandler().V(a,"change",v(this.jXb,this));a=this.C[5].getElement();this.L.hj(a);gS(this.L,a);this.L.render();fS(this.L);this.getHandler().V(a,"change",v(this.iXb,this));if(this.mb){a=this.va().getElement(jTd.p2a);var b=this.va().getElement(jTd.q2a);
this.fb.rb(a);Ys(this.fb,b);this.fb.Bc(!Q4a||hvb(this.R.F))}};p.setVisible=function(a){if(a){if(!this.sb){sTd(this);return}var b=this.R.L;rTd(this,0,b.C);b=b.H||K3b().name();rTd(this,1,b);rTd(this,2,Su(this.F,3)&&W(this.F,3).Qma()?W(this.F,3).vja().toString():"");rTd(this,3,Su(this.F,3)&&Su(W(this.F,3),1)?W(W(this.F,3),1)?"ON":"OFF":"OFF")}N2.oa.setVisible.call(this,a);this.sb&&!this.Hb&&((a=Wd("ds-settings-link"))&&Ad(a,this.Fb),this.Hb=!0)};
function sTd(a){Lr(xt(a.Vc.bf("/info/settings"),tTd()),v(function(a){a=a.hf();(a={locale:a.l?this.iK(a.l):null,kTa:a.tz?this.iK(a.tz):null,M6a:a.dls,JIb:a.dln,gXb:a.hl},a.locale)&&a.kTa&&(uTd(this,0,a.locale),uTd(this,1,a.kTa),uTd(this,2,kTd),uTd(this,3,lTd),this.Fb=a.M6a,this.Jb=a.JIb,this.$b=a.gXb,this.mb=Q4a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.$b),this.sb=!0);this.setVisible(!0)},a)).He()}
function tTd(){var a=Rl(yz("win").location.href),b=Pl(a,"hl");a=Pl(a,"forcehl");return["hl",b,"forcehl",a]}function uTd(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Rk(e.caption,e.value);a.Ad(e);Gh(e.getElement(),"menuitem")}a.zc().getElement().style.overflow="auto";PO(a,!0)}p.iK=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function rTd(a,b,c){(a=a.C[b])&&a.eb(c)}
p.PZb=function(a){"save"==a.key&&("ON"!=this.C[3].Ve().getValue()||""==this.Ea&&""==this.Aa?(vTd(this),a=this.R.L.C,this.Ob.C(wTd(this)),this.Ob.C(xTd(this)),yTd(this,a)):(a.preventDefault(),vTd(this),""!=this.Ea&&eS(this.O,this.Ea,!0),""!=this.Aa&&eS(this.L,this.Aa,!0)))};p.TUb=function(a){if("ON"==a.target.getValue())for(a=0;a<this.J.length;a++)M(this.J[a],!0);else qTd(this);vTd(this)};function vTd(a){fS(a.O);fS(a.L)}
p.jXb=function(){this.Ea="";var a=this.C[4].getValue()||"";a=this.Sb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ea="Please enter an integer value.";else if(0>=a||1E4<a)this.Ea="Please enter a value between 1 and 10000."};p.iXb=function(){this.Aa="";var a=this.C[5].getValue()||"";a=this.Sb.parse(a);isNaN(a)?this.Aa="Please enter a numeric value.":0>a&&(this.Aa="Please enter a non-negative value.")};
p.LDb=function(a){switch(a.target.getId()){case "general-settings-tab":M(this.jb,!0);M(this.Oa,!1);break;case "calculation-settings-tab":M(this.jb,!1),M(this.Oa,!0)}};function wTd(a){var b=a.C,c=b[iTd.HVa].Ve().getValue(),d=b[iTd.WYa].Ve().getValue();a=b[iTd.qZa].getValue()||"";b=b[iTd.JWa].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new eTd(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function xTd(a){var b=a.C;a=a.R.L;var c=b[iTd.k3].Ve();c=null==c?a.C:c.getValue();b=b[iTd.K1a].Ve();b=null==b?a.H||K3b().name():b.getValue();return new S3b(c,b)}function zTd(a,b){a=a.C[0].Ve();return null!=a&&a.getValue()!=b}function yTd(a,b){(ATd(a)||zTd(a,b))&&lsa(a.R.D.C,function(){yz("win").location.reload()})}function ATd(a){if(!a.mb)return!1;var b=!Q4a||hvb(a.R.F),c=a.fb.isChecked();return b!=c?(pvb(a.R,c),b=Sj(new Rj,1).build(),a.rc.Zb(c?2433:2434,b),!0):!1}
p.Ha=function(){lc(this.C,C);delete this.C;N2.oa.Ha.call(this)};function BTd(a,b,c,d,e,f,h,k){Tp.call(this,void 0,!1,k);this.J=this.L=this.R=this.O=null;this.Oa=a;this.C=b;this.Aa=h;this.F=[];this.Ea=new Ukc(a,d,e,f)}q(BTd,Tp);p=BTd.prototype;
p.Da=function(){Tp.prototype.Da.call(this);var a=this.va(),b=this.C.Rc(),c=ZF(Jw(b)),d=ZF(new Md(b.left+b.width-1,b.top+b.height-1));Up(this,"Sort range from "+(c+(" to "+d)));CTd||(c=new bq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),CTd=c);eq(this,CTd);pq(this,"save");var e;c=a.Da("DIV",{style:"overflow: hidden"},d=a.Da("SPAN","jfk-checkbox"),e=a.Da("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.J=new $s(void 0,a);f.rb(d);Ys(f,e);1==b.height&&f.Pa(!1);aI(this.Oa,this.C.Ec(),
b)||(f.Bc(!0),f.Pa(!1));I(H(),"fetdrisd")&&ritz_api.TablesApi.getTables((new $u).serialize(Qw(b,this.C.Ec())),v(function(a){if(0<a.length){var c=a[0];a=$O(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c)&&1==SZa(Ow(a)))c=Qw(b,this.C.Ec()),c=a.Ib()==c.Ib()&&OZa(Ow(a),Ow(c))&&OZa(Pw(a),Pw(c));c&&f.Bc(!0)}},this));d=this.Pb();a.appendChild(d,c);this.O=a.Da("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Da("TABLE",{cellSpacing:"0"},this.R=a.Da("TBODY")));
a.appendChild(d,this.O);c=DTd(this);this.F.push(c);c=a.Da("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);Be(c,!0);Gh(c,"button");this.L=c};p.Ja=function(){Tp.prototype.Ja.call(this);this.getHandler().V(this,"dialogselect",this.tKb).Bg(this.L,pf,this.Ejb).V(this.J,"change",this.jsb)};
function DTd(a){var b=a.va(),c=0==a.F.length,d=new ETd(a,c,a.C,a.F.length,b),e=b.Da("TR",null,b.Da("TD",{colspan:"4"},b.Da("DIV","waffle-sd-row-separator")));d.render(a.R);b.appendChild(a.R,e);c||a.getHandler().Bg(d.D,pf,v(a.h6a,a,d));a=FTd(a);GTd(d,a);return d}p.h6a=function(a){var b=this.F;if(1<b.length){var c=Ta(b,a);-1!=c&&(lb(b,c),b=a.getElement(),b=ue(b),a.dispose(),qe(b),M(this.L,!0),this.L.focus(),Lz("Sort criteria removed."))}};
function FTd(a){var b=a.C.Rc(),c=b.Ac();b=b.hd();var d=Wa(a.F,function(a){return a.Wj()},a);if(d)for(var e=tmb(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.ye.C[f];if(!db(d,h))return h}return null}p.jsb=function(){for(var a=this.F,b=0;b<a.length;b++)GTd(a[b])};p.Ejb=function(){var a=Iw(this.C.Rc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(DTd(this)),Lz("Sort criteria added."));pi(Sa(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&M(this.L,!1)};
p.tKb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Wj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Rc();d=Iw(c,"r");this.J.isChecked()&&1<d&&(c=JZa(c,-1));d=Sj(new Rj,1).build();this.Aa.Zb(this.J.isChecked()?35697:35698,d);a=new Tkc(a,b,this.C,c,this.J.isChecked());Vkc(this.Ea,this.C,a)}};p.Ha=function(){Tp.prototype.Ha.call(this);Eb(this.F)};var CTd=null;
function ETd(a,b,c,d,e){N.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.R=-1;this.ma=a;this.O=b;this.H=c}q(ETd,N);ETd.prototype.Wj=function(){var a=this.C.Ve();return a?a.getValue():-1};
ETd.prototype.Da=function(){var a=this.va(),b=this.O?"sort by":"then by",c,d,e,f=a.Da("TR","waffle-sd-tr-rules",a.Da("TD","waffle-sd-delete",this.O?"":this.D=a.Da("SPAN",{title:"Remove sort criteria."},"x")),a.Da("TD","waffle-sd-td-rules",a.Da("LABEL",{id:Mi(this,"csl")},b)),b=a.Da("TD","waffle-sd-column-selector"),a.Da("TD","waffle-sd-td-ascending",e=a.Da("DIV",null,c=a.Da("DIV",{title:"Ascending"}),d=a.Da("DIV",{title:"Descending"}))));Gh(e,"radiogroup");e=this.F=new VS(a,Me(a,fp(mC(!0,this.we()))),
"ascending");e.render(c);a=this.L=new VS(a,Me(a,fp(mC(!1,this.we()))),"descending");a.render(d);this.J=new XS([e,a]);YS(this.J,e);a=this.C=D2();a.render(b);Hh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(Be(this.D,!0),Gh(this.D,"button"),Lh(this.D,"Remove sort criteria."));this.Lb(f)};
function GTd(a,b){var c=a.va(),d=a.ma.J.isChecked(),e=a.H.Rc(),f=e.Cc(),h=e.Ac();e=e.hd();a.R=b||a.Wj();for(b=a.C.ai();0<b;b--)a.C.bC(0);for(;h<e;h++)b=Vb(ME(a.H.ih(f,h)),25),b=new Rk(Lb(b)||!d?"Column "+VF(h):b,a.H.ye.C[h],c),b.Id("waffle-sd-menu-item"),a.C.Ad(b);a.C.Xe(0);0<=a.R&&a.C.eb(a.R)}ETd.prototype.Ha=function(){N.prototype.Ha.call(this);this.C=this.D=this.H=this.ma=null;C(this.F);C(this.L);C(this.J);this.J=this.L=this.F=null};function HTd(a,b,c){return IDa(a||"There was a problem",td(b),void 0,void 0,void 0,void 0,c)};function ITd(a){return Q("<li class='nfd-format-pill'><div class='nfd-format-display'>"+P(a.geb)+"</div><div class='nfd-format-sample'>"+P(a.cSb)+"</div></li>")};function JTd(a,b,c){N.call(this);this.Jc(a);this.D=b;this.C=c}x(JTd,N);p=JTd.prototype;p.Da=function(){var a=this.kb(),b=this.C?eba(a.bz(),30):a.bz();a=this.C?Ufc(a,this.D):"";b=O(ITd,{geb:b,cSb:a});this.Lb(b)};p.Ja=function(){JTd.oa.Ja.call(this);Be(this.getElement(),!0);var a=new sk(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.b_b).V(this.getElement(),"mousedown",this.a_b).V(this.getElement(),"dblclick",this.lpb)};
p.b_b=function(a){function b(a,b){for(;b=a(b);)if(Ai(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(ue,this.getElement());break;case 38:b(Wca,this.getElement())}};p.a_b=function(a){a.preventDefault();this.dispatchEvent("change")};p.lpb=function(){this.dispatchEvent("action")};function KTd(a,b,c){N.call(this);this.D=b;this.C=c;LTd(this,a)}x(KTd,N);KTd.prototype.Da=function(){var a=this.va().Da("UL","nfd-pill-container");this.Lb(a)};function LTd(a,b){z(b,function(b){a.Ia(new JTd(b,a.D,a.C),!0)})}KTd.prototype.filter=function(a){a=a.toLowerCase();this.nf(function(b){var c=Lb($b(a)),d=b.kb().bz().toLowerCase();c=c||Ub(d,a);M(b.getElement(),c)})};function O2(a){Tp.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Zga();this.Ia(this.input,!0);this.J=new N;this.Ia(this.J,!0);a=this.M6();sb(a,void 0,rRd);this.C=new KTd(a,this.vY(),this.jSa());this.J.Ia(this.C,!0);eq(this,null);this.Hi=!0}x(O2,Tp);p=O2.prototype;p.GUa=Se;p.jSa=Re;p.isEmpty=function(){return Lb(this.input.getValue())};p.qf=function(){return this.input.kb().qf()};p.Da=function(){O2.oa.Da.call(this);var a=ge("DIV","dialog-separator");pe(a,Xp(this))};
p.Ja=function(){O2.oa.Ja.call(this);L(this.J.getElement(),"nfd-dialog-content");this.getHandler().V(this.C,"change",this.qrb).V(this.C,"action",this.Ata).V(this.input.O,"action",this.Ata).V(this.input,"afterhide",this.Rjb);this.input.R&&this.getHandler().V(this.input.R,"input",this.UZb);var a=this.input.Aa;a&&this.getHandler().V(a,"key",this.VZb);a=this.M6()[0];this.input.bN(a)};p.Rjb=function(a){a.stopPropagation()};p.qrb=function(a){this.input.bN(a.target.kb());MTd(this.input,!1)};
p.UZb=function(){this.C.filter(this.input.getValue());MTd(this.input,!this.input.kb().qf())};p.VZb=function(a){13==a.keyCode&&this.Ata()};p.Ata=function(){this.qf()&&!this.isEmpty()?(m7a.gc(new ZO(this.z2(),void 0,this.GUa())),this.setVisible(!1)):(MTd(this.input,!0),this.input.aDa())};function P2(a){N.call(this);this.J=new N;this.Ba(this.J);this.D=new wP("");this.Ba(this.D);this.O=new Rq("");this.Ba(this.O);this.ma=a;this.Aa=null}x(P2,N);p=P2.prototype;
p.Ja=function(){P2.oa.Ja.call(this);var a=Oi(this,"nfd-icwr");this.J.rb(a);this.Ia(this.J);if(a=Oi(this,"nfd-i"))this.D.rb(a),this.D.Qd(this.J),Ph(this.D.getElement(),"jfk-textinput"),a=new Br,a.rb(this.D.getElement()),this.Ba(a),this.R=a=new Ar(this.D.getElement()),this.Ba(a),this.Aa=a=new sk(this.D.getElement()),this.Ba(a),a=new Rp(this.D.getElement()),this.getHandler().V(a,"focusout",Da(this.EUa,!1)).V(a,"focusin",Da(this.EUa,!0)).V(this.R,"input",this.TZb);a=Oi(this,"nfd-a");this.O.rb(a);this.Ia(this.O)};
p.getValue=function(){return this.D.getValue()};p.TZb=function(){var a=this.kb(),b=this.getValue();X(a.uH,2,b);this.FUa()};p.FUa=Se;p.EUa=function(a){Rh(this.J.getElement(),"nfd-input-focus",a)};p.bN=function(a){this.Jc(a.clone());this.D.eb(a.bz());try{this.D.getElement().focus()}catch(b){}};p.aDa=function(){this.D.getElement().focus()};function MTd(a,b){a=a.J.getElement();Rh(a,"nfd-invalid",b)};function NTd(a,b,c){b=c||b;return Q("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+S(a.m_)+"'>"+OTd(a)+"</div>"+PTd(a,b)+"</div>")}function QTd(a,b,c){b=c||b;return Q("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+S(a.m_)+"'></div>"+PTd(a,b)+"</div>")}
function RTd(a,b,c){b=c||b;return Q("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+S(a.m_)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+OTd(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+S(a.qHb)+"'></div></div></div></div>"+PTd(a,b)+"</div>")}
function STd(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+TTd({label:""});a+=TTd({label:Eq("Negative:")});a+=TTd({label:Eq("Zero:")});a+=TTd({label:Eq("Text:")});return Q(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function TTd(a){return Q("<tr><td class='nfd-sample-label'>"+P(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function PTd(a,b){a=""+P(Qq({id:a.nW,style:2,Jd:"nfd-apply",content:Dq("Apply")},b));return Q(a)}function OTd(a){return Q(P(OSd({id:a.DKa,X$:a.EKa,eXb:!0})))};function Q2(a,b,c,d,e){Rk.call(this,b,c,d,e);this.C=a}x(Q2,Rk);Q2.prototype.Yj=function(){var a=Q2.oa.Yj.call(this),b=this.getParent();return b&&b instanceof Lk&&!b.isVisible()?this.C(a,this.kb()):a};function UTd(a){P2.call(this,a);this.F=new N;this.C=new XL("")}x(UTd,P2);p=UTd.prototype;p.Da=function(){var a=O(RTd,{m_:Mi(this,"nfd-icwr"),DKa:Mi(this,"nfd-i"),EKa:this.ma,qHb:Mi(this,"nfd-ic"),nW:Mi(this,"nfd-a")});this.Lb(a)};p.Ja=function(){UTd.oa.Ja.call(this);var a=Oi(this,"nfd-ic");this.F.rb(a);this.F.Qd(this.J);this.F.Ia(this.C,!0);this.getHandler().V(this.C,"aftershow",this.WZb).V(this.C,"action",this.IHa).V(this.R,"input",Da(this.VTa,null))};
p.bN=function(a){UTd.oa.bN.call(this,a);a.C&&this.D.eb(vs[a.C][1]);this.VTa(a)};
p.VTa=function(a){a=a?a.C:void 0;var b=this.C;b.Kf(null);if(a){var c=this.kb(),d=c.C;VTd(this,c);c=Zkc(d,vs[d][2]);c=new ZO(WTd(c),Ykc[d],d);VTd(this,c);c=Zkc(d,d+" "+vs[d][1]);d=new ZO(WTd(c),Ykc[d],d);VTd(this,d)}else this.kb().C=null;var e="[$"+this.getValue()+"]";d=a?Ykc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new ZO(WTd(c[e]),d,a);VTd(this,f)}b.Xe(0);this.IHa();L(b.zc().getElement(),"number-format-menu")};function VTd(a,b){var c=new Q2(function(a){return eba(a,25)},Ufc(b,1E3),b);a.Ba(c);a.Ba(b);c.xp(!0);a=a.C;for(b=0;b<a.ai();b++)if(a.Ue(b).Yj()==c.Yj())return;a.Ad(c)}p.IHa=function(){for(var a=this.C,b=0;b<a.ai();b++)a.Ue(b).Bc(!1);a.QD()};p.WZb=function(){this.C.Ve().Bc(!0)};function WTd(a){var b=new fv;X(b,2,a);b.setType(4);return b};function XTd(a){O2.call(this,a);Up(this,"Custom currencies")}x(XTd,O2);p=XTd.prototype;p.vY=n(1000.12);p.Zga=function(){return new UTd("Custom currency")};p.M6=function(){var a=this;dic();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=Ykc[e]:kRd(d,alc(d.Al()))}var f=[];lc(vs,function(b,c){b=$kc(c);a.Ba(b);f.push(b)});var h=aNc();wb(f,function(a,b){return h(a.bz(),b.bz())});return b.concat(f)};
p.z2=function(){var a=new fv;a.setType(4);X(a,3,1);var b=this.input.C.Ve().getValue().Al();X(a,2,b);return a};p.GUa=function(){return this.input.kb().C};function YTd(a){N.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(YTd,N);YTd.prototype.Da=function(){var a=O(STd);this.F=$d("nfd-sample-label",a);this.D=Nca("nfd-rendered-sample",a);this.Lb(a)};function R2(a,b){P2.call(this,a);this.C=new YTd(b);this.Jc(new ZO(""))}x(R2,P2);R2.prototype.Da=function(){var a=O(NTd,{DKa:Mi(this,"nfd-i"),EKa:this.ma,m_:Mi(this,"nfd-icwr"),nW:Mi(this,"nfd-a")});this.Lb(a)};R2.prototype.Ja=function(){R2.oa.Ja.call(this);this.Ia(this.C,!0);ZTd(this)};R2.prototype.FUa=function(){ZTd(this)};R2.prototype.bN=function(a){R2.oa.bN.call(this,a);ZTd(this)};
function ZTd(a){var b=a.kb();if(b){var c=a.C;a=b.Al().split(";").length-1;ze(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=Ufc(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Al()),k=d<=a;M(we(e),k);ze(e,f);ci(e,"color",h||"")}d=b.qf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Al()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Al());c=c.D[3];M(we(c),3<=a);ze(c,d);ci(c,"color",b||"")}};function $Td(a){O2.call(this,a);Up(this,"Custom number formats")}x($Td,O2);$Td.prototype.vY=n(1234.56);$Td.prototype.Zga=function(){return new R2("Custom number format",1234.56)};
$Td.prototype.M6=function(){var a=this.F;a.push(new ZO("0"));a.push(new ZO("0.00"));a.push(new ZO("#,##0"));a.push(new ZO("#,##0.00"));a.push(new ZO("#,##0_);(#,##0)"));a.push(new ZO("#,##0_);[Red](#,##0)"));a.push(new ZO("#,##0.00_);(#,##0.00)"));a.push(new ZO("#,##0.00_);[Red](#,##0.00)"));a.push(new ZO("$#,##0_);($#,##0)"));a.push(new ZO("$#,##0_);[Red]($#,##0)"));a.push(new ZO("$#,##0.00_);($#,##0.00)"));a.push(new ZO("$#,##0.00_);[Red]($#,##0.00)"));a.push(new ZO("@"));a.push(new ZO("0%"));a.push(new ZO("0.00%"));
a.push(new ZO("0.00E+00"));a.push(new ZO("##0.0E+0"));a.push(new ZO("# ?/?"));a.push(new ZO("# ??/??"));a.push(new ZO('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new ZO('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new ZO('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new ZO('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};$Td.prototype.z2=function(){var a=new fv;a.setType(2);X(a,3,1);var b=this.input.getValue();X(a,2,b);return a};function S2(a,b){Wk.call(this,b,new aUd(a))}x(S2,Wk);p=S2.prototype;p.ag=function(a,b,c){S2.oa.ag.call(this,a,b,c);a.Qb()&&this.Qb()&&a.getParent()==this&&bUd(this)};p.Ja=function(){S2.oa.Ja.call(this);bUd(this)};p.Xc=function(a){S2.oa.Xc.call(this,a);bUd(this)};p.removeChild=function(a,b){a=S2.oa.removeChild.call(this,a,b);bUd(this);return a};p.Sn=function(a,b){a=S2.oa.Sn.call(this,a,b);bUd(this);return a};
p.Dj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Ok(this);if(c){b=39==b;this.we()&&(b=!b);c=c.getElement();c=Ta(c.parentNode.childNodes,c);var d=(d=(d=Ok(this))?kda(d.getElement(),cUd):null)?Ta(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=dUd(this,e);b?b=dUd(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Uaa(this.Tq()+b);b=!0}else b=!1}b=!b}return b?S2.oa.Dj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function dUd(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function bUd(a){var b,c=a.Td(),d=a.fd(),e=pb(Zd("div",cUd,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.va().Da("DIV",cUd),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.fd();k++)a.Zc(k)instanceof Vk?(d.push(new eUd(b,k,!0)),b=k+1):a.Zc(k)instanceof Qk&&(0==k?h=!0:(a.Zc(k-1),d.push(new eUd(b,k-1,!1)),b=k));k=a.fd();0<d.length&&Sa(d).end!=k-1&&d.push(new eUd(b,k-1,!1));b=h;h=a.fd();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.fd()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else fUd(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.fd();f++){for(;f>c[d];)++d;b=a.Zc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Vk?M(h,!1):M(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function fUd(a,b,c){function d(a){return a.end-a.start-(a.jGb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;ib(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,ib(a,l,1))}}function eUd(a,b,c){this.start=a;this.end=b;this.jGb=c}function aUd(a){Uk.call(this);this.D=a}x(aUd,Uk);var cUd="docs-multi-menu-col";function gUd(a){A.call(this);this.C=a}x(gUd,A);gUd.prototype.create=function(){return new S2(this.C)};function hUd(a,b){P2.call(this,a);this.qa=new N;this.H=new iUd;this.F=new N;a=(new gUd(3)).create();a.Ia(new Qk("Date"),!0);a.Ia(new Rk("Day","DAY_TOKEN"),!0);a.Ia(new Rk("Month","MONTH_TOKEN"),!0);a.Ia(new Rk("Year","YEAR_TOKEN"),!0);a.Ia(new Qk("Time"),!0);a.Ia(new Rk("Hours","HOURS_TOKEN"),!0);a.Ia(new Rk("Minutes","MINUTES_TOKEN"),!0);a.Ia(new Rk("Seconds","SECONDS_TOKEN"),!0);a.Ia(new Rk("Milliseconds","MILLIS_TOKEN"),!0);a.Ia(new Rk("AM/PM","AM_PM_TOKEN"),!0);a.Ia(new Qk("Duration"),!0);a.Ia(new Rk("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Ia(new Rk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ia(new Rk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new ISb(a);this.C=b}x(hUd,P2);p=hUd.prototype;p.Da=function(){var a=O(QTd,{m_:Mi(this,"nfd-icwr"),nW:Mi(this,"nfd-a")});this.Lb(a)};
p.Ja=function(){hUd.oa.Ja.call(this);L(this.getElement(),"nfd-date-time-input");var a=Oi(this,"nfd-icwr"),b=this.qa;b.rb(a);b.Qd(this);b.Ia(this.L,!0);L(this.L.getElement(),"nfd-date-time-menu-button");L(this.L.zc().getElement(),"nfd-date-time-menu");Lh(this.L.$a(),"Add a date or time format");b.Ia(this.H,!0);Qc||L(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ia(a,!0);ci(a.getElement(),"display","inline");this.getHandler().V(this,"qf",Da(this.HUa,"left")).V(this,"uf",Da(this.GIa,"left")).V(this,
"vf",Da(this.GIa,"right")).V(this,"wf",Da(this.qJa,"left")).V(this,"xf",Da(this.qJa,"right")).V(this,"tf",Da(this.HUa,"right")).V(this.L,"action",this.fob)};p.aDa=function(){this.qa.getElement().focus()};
p.bN=function(a){this.Jc(a.clone());var b=this.F;b.Fd(!0);ze(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Al());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?ze(this.H.getElement(),d[2]):(e=b.Zc(b.fd()-1),d=d[2],ze(e.aA.getElement(),De(e.aA.getElement())+d)):jUd(this,e).eb(d[1])}0<b.fd()&&b.Zc(b.fd()-1).iy.getElement().focus()};
p.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.fd();b++)a+=this.F.Zc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Wb(e,"["),e=Wb(e,"]")):c=!0}b+=e}return b};p.fob=function(a){a=a.target.getValue();jUd(this,a).iy.getElement().focus()};
function jUd(a,b){MTd(a,!1);switch(b){case "DAY_TOKEN":var c=kUd(a);break;case "MONTH_TOKEN":c=lUd(a);break;case "YEAR_TOKEN":c=mUd(a);break;case "HOURS_TOKEN":c=nUd();break;case "MINUTES_TOKEN":c=oUd();break;case "SECONDS_TOKEN":c=pUd();break;case "MILLIS_TOKEN":c=qUd();break;case "AM_PM_TOKEN":c=rUd(a);break;case "ELAPSED_HOURS_TOKEN":c=sUd();break;case "ELAPSED_MINUTES_TOKEN":c=tUd();break;case "ELAPSED_SECONDS_TOKEN":c=uUd()}b=c;b.Ia(new Vk,!0);b.Ia(new Rk("Delete"),!0);c=new vUd(c,"");a.F.Ia(c,
!0);return c}p.HUa=function(a,b){b=b.target;if(b instanceof iUd){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Zc(Pi(this.F,b)+1),!b))return}a=De(b.aA.getElement());var c=b.getParent(),d=Pi(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=De(b),ze(b,c+a),wUd(this.H,c.length)):(d--,b=c.Zc(d),c=De(b.aA.getElement()),ze(b.aA.getElement(),De(b.aA.getElement())+a),wUd(b.aA,c.length))};
p.qJa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Zc(Pi(this.F,b)+a))&&a.iy.getElement().focus()};p.GIa=function(a,b){var c="left"==a?-1:0;(b=this.F.Zc(Pi(this.F,b.target)+c))||"left"!=a?b&&(b=b.aA):b=this.H;c=De(b.getElement()).length;wUd(b,"left"==a?c:0)};function vUd(a,b){N.call(this);this.iy=new XL("",a);this.Ia(this.iy,!0);this.aA=new iUd(b);this.Ia(this.aA,!0)}x(vUd,N);p=vUd.prototype;
p.Ja=function(){vUd.oa.Ja.call(this);ci(this.getElement(),"display","inline-block");this.iy.Xe(0);this.C=new sk(this.iy.getElement());this.Ba(this.C);this.getHandler().V(this.iy,"action",this.XZb).V(this.C,"key",this.YZb)};p.XZb=function(){this.iy.QD();this.iy.Ve().kb()||this.dispatchEvent("tf")};p.YZb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("tf"));break;case 37:a.preventDefault();this.dispatchEvent("uf");break;case 39:a.preventDefault(),this.dispatchEvent("vf")}};
p.toString=function(){return this.iy.Ve().kb()+this.aA.toString()};p.eb=function(a){this.iy.eb(a)};function iUd(a){N.call(this);this.C=a||""}x(iUd,N);p=iUd.prototype;p.Da=function(){var a=ge("SPAN");ae(a,{contentEditable:!0});ze(a,this.C);var b=a.style;Mc&&!Wc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Qc?"-moz-pre-wrap":"pre-wrap";this.Lb(a)};
p.Ja=function(){iUd.oa.Ja.call(this);var a=new sk(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.ZZb).V(this.getElement(),"paste",this.$Zb)};function wUd(a,b){if(0==De(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=pK(c,b);a.getElement().focus();b.select()}}
p.ZZb=function(a){var b=Ce(this.getElement()),c=fK(),d=De(this.getElement()).length,e=c?0==c.Dh()&&0==c.En():Lb($b(b));b=c?c.Dh()==d&&c.En()==d:Lb($b(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("qf"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("tf"));break;case 40:this.dispatchEvent("rf");break;case 38:this.dispatchEvent("sf");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("wf"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("xf"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Nb(De(this.getElement())).replace(/"/g,'"\\""');return 0==$b(a).length?"":'"'+a+'"'};p.$Zb=function(){var a=v(function(){ze(this.getElement(),De(this.getElement()))},this);Yi(a)};
function kUd(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new Q2(Da(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function lUd(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new Q2(Da(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function mUd(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new Q2(Da(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function nUd(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function oUd(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function pUd(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function qUd(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function rUd(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new Q2(Da(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new Q2(Da(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function sUd(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function tUd(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function uUd(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new Q2(Da(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c};function xUd(a){O2.call(this,a);Up(this,"Custom date and time formats")}x(xUd,O2);p=xUd.prototype;p.jSa=Qe;p.vY=n(11175.5628472222);p.isEmpty=function(){return Lb(Xu(this.z2(),2))};p.qf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Xu(this.z2(),2))};p.Zga=function(){return new hUd("Custom date time format",11175.5628472222)};p.z2=function(){return yUd(this.input.getValue())};
p.M6=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.vY(),c.Al());c.D=d}b=zUd(this);sb(b);for(c=0;c<b.length;c++)a.push(new ZO(yUd(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.vY(),b[c])));return a};
function zUd(a){var b=is,c=Wa(b.DATEFORMATS,function(a){return AUd(a)},a),d=Wa(b.TIMEFORMATS,function(a){return AUd(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;sb(b);a=Wa(b,function(a){return AUd(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function AUd(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ob(a.join(""))}function yUd(a){var b=new fv;b.setType(7);X(b,3,1);X(b,2,a);return b};function BUd(a,b){this.D=a;this.C=b}BUd.prototype.getUrl=g("D");BUd.prototype.getTitle=g("C");function CUd(a,b,c,d,e,f){wr.call(this,a,b,"domain",d,e,f);this.H=c}x(CUd,wr);CUd.prototype.aW=function(){var a=CUd.oa.aW.call(this);a.domainName=this.H;return mc(a,PFa)};hGa.set("domain",function(a){return new CUd(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new CUd("","DEFAULT","",!0);function DUd(){};function EUd(a){for(var b="",c=a.tTb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.rTb[f.Eh()],k=f.getLabel();f=f.ZGb;f=Q('<div id="'+S(h)+'" tabindex="0" role="link" class="'+S("ess-button")+'" aria-label="'+S(k)+'"><div class="'+S("ess-icon")+" "+S(f)+'"></div></div>');b+=f}return Q(b)};function FUd(a,b){N.call(this,b);this.D=a||[];this.F=[];this.C=null}x(FUd,N);p=FUd.prototype;p.Vd=!0;p.lfa=!1;p.IP=null;p.oBa=!1;p.Pa=function(a,b){this.Vd=a;this.lfa=b;if(this.oBa){b=this.va();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.IP.ura+"-"+d.Eh()),f=a;Rh(e,"ess-button",f);Rh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();tj(e,f,d)}}};
p.Da=function(){this.Lb(this.xb.createElement("SPAN"));var a={};a.ura=Mi(this,"service");a.tTb=this.D;this.IP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Eh()]=this.IP.ura+"-"+d.Eh();a.rTb=b;this.IP=a;vq(this.getElement(),EUd,this.IP);this.oBa=!0};
p.lRb=function(a){if(this.Vd){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.lfa)this.dispatchEvent(new GUd(new HUd(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={gKc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=dp(b,a))&&a.focus()}}};
p.Ja=function(){this.Pa(this.Vd,this.lfa);for(var a=this.va(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.IP.ura+"-"+d.Eh());b.Bg(e,pf,v(this.lRb,this,d))}};p.Ha=function(){FUd.oa.Ha.call(this);delete this.F;delete this.D;this.C=null};function GUd(a,b){D.call(this,"yf",b);this.context=a}x(GUd,D);function HUd(){}x(HUd,DUd);function T2(a,b,c,d){this.C=a;this.F=b;this.D=c;this.ZGb=d;this.H=IUd++}var IUd=0;T2.prototype.Eh=g("H");T2.prototype.getName=g("F");T2.prototype.getLabel=g("D");function JUd(){T2.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(JUd,T2);JUd.prototype.getUrl=function(a){var b=Wa(a,function(a){return a.getTitle()});a=Wa(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Qb(a.join(","))+"&t="+Qb(b.join(","))};function KUd(){T2.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(KUd,T2);KUd.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Qb(a[0].getUrl())};function LUd(){T2.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(LUd,T2);LUd.prototype.getUrl=function(a){a=Wa(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Qb(a.join("\n"))};function MUd(){T2.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(MUd,T2);MUd.prototype.getUrl=function(a){for(var b=qa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Qb(a)};function U2(a){N.call(this,a)}x(U2,N);function NUd(a){a.dispatchEvent(new D("zf"))}U2.prototype.zY=function(){return{}};U2.prototype.zK=Se;U2.prototype.ora=ta;function OUd(a){N.call(this,a)}x(OUd,N);OUd.prototype.F=Se;OUd.prototype.H=ta;OUd.prototype.J=ta;function PUd(a,b,c){b=c||b;c='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+qRd(a.locale)+'&answer=183965">Learn more</a>');c=c+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';
c+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';c+="Embed";c+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+S(a.p9a)+'" readonly="readonly" aria-label="';c+=Hq("Link to published document.");c+=" "+S(a.IPa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';
c+="Or share this link using:";c+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';c+=Hq("HTML embed code of published document.");c+=" "+S(a.IPa)+'">'+gEa(a.hdb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+P(Qq({id:"pub-dialog-publish-link-button",
style:2,value:a.kRb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+P(Cr({Ft:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));c+="Published content & settings";c+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+P(Qq({id:"pub-dialog-publish-button",value:a.iRb},b))+'<div class="pub-dialog-checkbox-container">';
a.CHb&&(c+=P(Zs({id:"pub-dialog-dom-signin-req",checked:a.Ys,disabled:a.WJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.WJ?' class="pub-dialog-disabled-text"':"")+">",d="Require viewers to sign in with their "+(P(a.domain)+" account"),c+=d,c+="</label><br>");a.SP&&(c+=P(Zs({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">',c+="Automatically republish when changes are made",
c+="</label>");c+="</div></div></div></div></div>";return Q(c)};function V2(a,b,c,d,e,f,h,k,l,m){Vs.call(this);this.Bb=a||"";this.Ge=b;this.dd=c;this.Vc=d;this.Hc=l||"/publishsettings";this.C=new QUd(e);this.Hb=new FUd([new KUd,new LUd,new JUd,new MUd]);this.Ia(this.Hb);this.Aa=new Rq(null,this.va());this.Ia(this.Aa);this.R=new Rq(null,this.va());this.Ia(this.R);this.jb=new $s(void 0,this.va());this.Ia(this.jb);this.Ea=new $s(void 0,this.va());this.Ia(this.Ea);this.mb=0;this.Sb=new RUd;this.Ia(this.Sb);this.Fb=this.Jb=null;this.J=f||new U2;this.Ia(this.J);this.F=
h||new U2;this.Ia(this.F);this.fb=k||new OUd;this.Ia(this.fb);this.O=this.L=null;this.Oa=new ur(void 0,SUd,this.va(),2);this.Ba(this.Oa);this.ue=this.od=null;this.Qe=m||new N;this.$b=this.sb=this.Ob=null;this.Hi=!0}x(V2,Vs);var SUd="Press "+((Tc?"\u2318+C":"Ctrl+C")+" to copy.");p=V2.prototype;p.kd=function(){V2.oa.kd.call(this);this.Oa.kd()};p.show=function(){TUd(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){V2.oa.setVisible.call(this,a);var b=Ke(this.va());a?this.getHandler().V(b,"resize",this.kd):this.getHandler().Pc(b,"resize",this.kd)};
p.Da=function(){V2.oa.Da.call(this);var a=this.va(),b=O(PUd,{CHb:!!this.C.domain,SP:this.C.SP(),Ys:this.C.Ys,domain:this.C.C,WJ:this.C.WJ,iRb:UUd(this),kRb:W2(this,VUd(this))?"Published":"Publish",p9a:this.C.Ik?WUd(this,this.J.zY()):"",hdb:this.C.Ik?XUd(this,this.F.zY()):"",locale:"en",IPa:SUd});a.appendChild(this.Pb(),b);Up(this,"Publish to the web");eq(this,null);L(this.Pb(),"pub-dialog-content")};
p.Ja=function(){var a=this.va(),b=a.getElement("pub-dialog-sharing-services-links");this.Hb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Ob=a.getElement("pub-dialog-links-notice");this.Qe.render(this.Ob);b=a.getElement("pub-dialog-published-content");this.fb.render(b);V2.oa.Ja.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.jb.rb(c),Ys(this.jb,a.getElement("pub-dialog-dom-signin-req-label")),
b.V(this.jb,"change",this.oWb));this.C.SP()&&(this.Ea.rb(a.getElement("pub-dialog-auto-publish-checkbox")),Ys(this.Ea,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.V(this.Ea,"change",this.kWb));this.Jb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Fb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");tr(this.Oa,this.L);this.Sb.rb(a.getElement("pub-dialog-links-tab-bar"));this.od=a.getElement("pub-dialog-sharing-services");
this.ue=a.getElement("pub-dialog-status-info");this.Aa.rb(a.getElement("pub-dialog-publish-link-button"));this.R.rb(a.getElement("pub-dialog-publish-button"));this.$b=new DN("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Ik);this.Ba(this.$b);b.V(this.Sb,"select",this.mBb).V(this.L,"focus",this.cRa).V(this.O,"focus",this.cRa).V(this.R,"action",this.mRb).V(this.getElement(),"keyup",this.D8a).V(this.J,"zf",this.Zsa).V(this.F,"zf",this.Zsa).V(this.Aa,"action",this.hzb).V(this.fb,"Af",
this.izb).V(this.$b,"toggle",this.kd);YUd(this)};function YUd(a){if(a.Qb()){var b=a.va(),c=a.C.Ik,d=a.C.WJ;a.fb.H(a.C.Lm);a.jb.Pa(!d);a.R.setContent(UUd(a));a.R.Pa(a.C.Ik||!a.C.Lm||!a.C.Lm.isEmpty());a.C.SP()&&a.Ea.Bc(a.C.yw);a.Zsa();b=b.Ei("pub-dialog-state-publishing");z(b,function(a){M(a,c)});ze(a.ue,c?"This document is published to the web.":"This document is not published to the web.");a.kd()}}p.D8a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function ZUd(a,b){var c=window.location.href,d=nl(c);c=ql(c);var e=Ub(c,"/"+a.Vc+"/")?"/"+a.Vc:"";a.C.Ys&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.Bb;b=yKa.test(b)?b:Fl("/d/"+a,b);return ml(c,f,h,d,Fl(e,b))}
p.Zsa=function(){var a=this.J.zK();if(a=W2(this,a)){var b=this.C.Ik?WUd(this,this.J.zY()):"";this.L.value=b;this.Hb.F=[new BUd(b,this.Ge)]}M(this.L,a);M(this.od,a&&!this.C.WJ);a=this.F.zK();if(a=W2(this,a))this.O.value=this.C.Ik?XUd(this,this.F.zY()):"";M(this.O,a);a=W2(this,VUd(this));M(this.Ob,a);this.Aa.Pa(!a);this.Aa.setContent(W2(this,VUd(this))?"Published":"Publish")};
p.mBb=function(a){a=a.target;this.va();UFa(this.Oa);"pub-dialog-link-tab"==a.getId()?(this.mb=0,M(this.Jb,!0),M(this.Fb,!1),tr(this.Oa,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.mb=1,M(this.Jb,!1),M(this.Fb,!0),tr(this.Oa,this.O));YUd(this)};p.cRa=function(a){Yi(function(){a.target.select()},0)};p.oWb=function(){this.C.Ik?$Ud(this,2,!1):this.C.Ys=!this.C.Ys};p.kWb=function(){this.C.Ik?$Ud(this,0,!1):this.C.yw=!this.C.yw};function UUd(a){return a.C.Ik?"Stop publishing":"Start publishing"}
function TUd(a,b){Lr(Vm(a.dd.bf(a.Hc),"id",a.Bb),v(function(a){this.C.Ik=!!Pt(a,"published");this.C.Ys=!!Pt(a,"requireSignin");this.C.WJ=!!Pt(a,"domainClosed");this.C.domain=xBc(a,"domain");this.C.C=xBc(a,"domainDisplay");this.C.yw=!Number(Pt(a,"revision"));this.C.Lm=this.EEa(a.hf());this.C.F=xBc(a,"publishedDocumentId");b()},a)).He()}p.EEa=Se;p.kEa=Se;function aVd(a){return{yw:a.C.yw,Ik:a.C.Ik,Ys:a.C.Ys,Lm:a.C.Lm}}
function $Ud(a,b,c){c=t(c)?c:!0;var d=aVd(a);switch(b){case 0:d.yw=!d.yw;break;case 1:d.Ik=!d.Ik;break;case 2:d.Ys=!d.Ys;break;default:throw Error("Unknown toggle op: "+b);}d.Ik||(d.Lm=a.kEa());bVd(a,d,c)}
function bVd(a,b,c){cVd(a,!1);Ct(Lr(Um(bt(Vm(a.dd.bf(a.Hc),"id",a.Bb),dVd(a,b)),2),v(function(){this.C.yw=b.yw;this.C.Ik=b.Ik;this.C.Ys=b.Ys;this.C.Lm=b.Lm;this.C.Ik&&this.C.Lm&&(W2(this,this.J.zK())||this.J.ora(this.C.Lm),W2(this,this.F.zK())||this.F.ora(this.C.Lm));cVd(this,!0);YUd(this);if(c&&this.C.Ik)switch(this.mb){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.mb);}},a)),v(function(){BLa("An error occurred while saving publishing settings.",
void 0,this.Qb()?this:void 0);cVd(this,!0);YUd(this)},a)).He()}function dVd(a,b){var c={id:a.Bb,requireSignin:b.Ys,published:b.Ik};a.C.SP()&&!b.yw&&(c.revision=a.C.D);b.Lm&&(a=eVd(b.Lm),Fc(c,a));return c}function cVd(a,b){for(var c=[a.Ea,a.R,a.Aa,a.jb],d=0;d<c.length;d++){var e=c[d];!b&&e.jm()&&(a.sb=e);e.Pa(b)}b&&a.sb&&(a.isVisible()&&a.sb.isVisible()&&(c=a.sb.getElement())&&c.focus(),a.sb=null);a.fb.J(b)}
p.mRb=function(a,b){if(b||window.confirm(this.C.Ik?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.R.setContent("Saving..."),$Ud(this,1)};function VUd(a){switch(a.mb){case 0:return a.J.zK();case 1:return a.F.zK();default:throw Error("Cannot handle selected link type "+a.mb);}}
p.hzb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=VUd(this),b=aVd(this);b.Ik=!0;a&&(b.Lm&&this.C.Ik?b.Lm=fVd(b.Lm,a):b.Lm=a);this.Aa.setContent("Publishing...");bVd(this,b,!0)}};p.izb=function(){var a=this.fb.F();if(this.C.Ik)if(a&&a.isEmpty())$Ud(this,1);else{var b=aVd(this);b.Lm=a;bVd(this,b)}else this.C.Lm=a,YUd(this)};function W2(a,b){var c;(c=a.C.Ik)&&!(c=!b||!a.C.Lm)&&(a=a.C.Lm,c=a.F||!b.F&&Za(b.D.zd(),a.y9,a)&&Za(b.C,a.n9,a));return c}
function QUd(a){this.D=a;this.WJ=this.Ys=this.Ik=!1;this.yw=!0;this.F=this.C=this.domain=""}QUd.prototype.SP=function(){return!!this.D};function RUd(){tS.call(this)}x(RUd,tS);RUd.prototype.Dj=function(a){return a.keyCode&&27==a.keyCode?!1:RUd.oa.Dj.call(this,a)};function gVd(a,b,c,d){this.F=a;this.Fh=b;this.C=c;this.D=d}function hVd(a,b){return new gVd(!1,null,new iVd(a,b||"interactive"),null)}function iVd(a,b){this.id=a;this.format=b};function X2(a,b,c){this.F=a;this.D=new HE(b);this.C=c}p=X2.prototype;p.y9=function(a){return this.F||this.D.contains(a)};function jVd(a,b){return Ya(a.C,function(a){return a.id==b.id})}p.n9=function(a){return this.F||this.D.contains(a.Fh)||jVd(this,a)};function kVd(a,b){a.C=Va(a.C,function(a){return a.Fh!=b})}function lVd(a,b){jVd(a,b)&&(a.C=Va(a.C,function(a){return a.id!=b.id}))}
function fVd(a,b){var c=a.F||b.F;if(c)return new X2(c,[],[]);var d=a.clone();z(b.D.zd(),function(a){d.D.contains(a)||(d.D.add(a),kVd(d,a))});z(b.C,function(a){d.n9(a)||d.C.push(a)});return d}function eVd(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.zd().join(","),charts:Wa(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&eb(this.C)};p.clone=function(){return new X2(this.F,this.D.zd(),pb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&yb(this.C,a.C,function(a,c){return a.id==c.id&&a.Fh==c.Fh})};function mVd(a,b){this.id=a;this.Fh=b};function nVd(a,b,c,d){N.call(this,void 0);this.C=c||new gVd(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new XL("",oVd(a,b));PO(this.D,!0);this.Ia(this.D,!0);a=new Wk;a.Ia(new Rk("Interactive","interactive"),!0);a.Ia(new Rk("Image","image"),!0);this.H=new XL("",a);this.Ia(this.H,!0);a=new Wk;a.Ia(new Rk("Web page","html"),!0);a.Ia(new Rk("Comma-separated values (.csv)","csv"),!0);a.Ia(new Rk("Tab-separated values (.tsv)","tsv"),!0);a.Ia(new Rk("PDF document (.pdf)","pdf"),!0);a.Ia(new Rk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ia(new Rk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new XL("",a);this.Ia(this.F,!0);pVd(this)}x(nVd,U2);var qVd=["xlsx","ods"],rVd=["csv","tsv"];
function oVd(a,b){var c=new Wk;c.Ia(new Rk("Entire Document",new sVd("entireDocument",null)),!0);c.Ia(new Vk,!0);var d=Bub(b);z(a.D,function(a){c.Ia(new Rk(a.pe(),new sVd("sheet",a.Ib())),!0);if(a=d[a.Ib()])for(var b={},e=0;e<a.length;b={uW:b.uW},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.uW=new Rk("",new sVd("chart",vH(k))),FH(k).then(function(a){return function(b){a.uW.Mm(b.getTitle())}}(b)),c.Ia(b.uW,!0),L(b.uW.Pb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=nVd.prototype;
p.Ja=function(){nVd.oa.Ja.call(this);L(this.getElement(),"pub-dialog-link-options-container");L(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");L(this.D.Pb(),"pub-dialog-link-options-document-part-menu-button-content");L(this.D.zc().getElement(),"pub-dialog-link-options-document-part-menu");Lh(this.D.$a(),"Sheet or chart selection");Lh(this.H.$a(),"Chart format");Lh(this.F.$a(),"Sheet format");this.getHandler().V(this.D,"change",this.epb).V(this.H,"change",this.Xlb).V(this.F,
"change",this.WBb).V(this.D,"afterhide",function(a){a.stopPropagation()}).V(this.H,"afterhide",function(a){a.stopPropagation()}).V(this.F,"afterhide",function(a){a.stopPropagation()})};p.epb=function(){var a=this.D.Ve().kb();switch(a.type){case "entireDocument":this.C=new gVd(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id+"";var b=this.C.D;b&&!tVd(this,a,b)&&(b=null);this.C=new gVd(!1,a,null,b||"html");break;case "chart":this.C=hVd(a.id,this.C.C?this.C.C.format:null)}pVd(this);NUd(this)};
p.Xlb=function(){var a=this.H.Ve().kb();this.C.C&&(this.C.C.format=a,NUd(this))};p.WBb=function(){var a=this.F.Ve().kb();this.C.D=a;NUd(this)};
function pVd(a){var b=pb(a.D.vj.C);b=bb(b,function(a){a=a.kb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Fh&&a.id==this.C.Fh;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);ir(a.D,b);b=!!a.C.C;M(a.H.getElement(),b);null!=a.C.C&&a.H.eb(a.C.C.format);M(a.F.getElement(),a.J&&!b);b||(uVd(a),a.F.eb(a.C.D))}
function uVd(a){for(var b=a.F.zc(),c=0;c<b.ai();c++){var d=b.Ue(c),e=d.getValue();d.Pa(null==a.C.Fh||tVd(a,a.C.Fh,e))}}function tVd(a,b,c){if(db(qVd,c))return!1;a=OF(a.O,b);return null!=a&&1==a.getSheetType()&&db(rVd,c)?!1:!0}p.zY=g("C");p.zK=function(){if(this.C.F)return new X2(!0,[],[]);if(null!=this.C.Fh)return new X2(!1,[this.C.Fh],[]);var a=this.L.C(this.C.C.id);a=new mVd(this.C.C.id,a.Ib());return new X2(!1,[],[a])};
p.ora=function(a){if(!a.F){var b=a.D.zd();0<b.length?this.C=new gVd(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=hVd(a[0].id)));pVd(this)}};function sVd(a,b){this.type=a;this.id=b};function Y2(a,b){Vq.call(this,void 0,void 0,new WL,void 0);this.Ea=a;this.qa=b;this.F=new X2(!0,[],[]);this.R=!1;this.H=new BN("Entire Document");this.Ad(this.H);this.Ad(new Vk);vVd(this);PO(this,!0);wVd(this)}x(Y2,Vq);function vVd(a){var b=Bub(a.qa);z(a.Ea.D,function(c){var d=new BN(c.pe(),c);a.Ad(d);(c=b[c.Ib()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new BN("",b);FH(b).then(function(a){c.Mm(a.getTitle())});a.Ad(c);L(c.Pb(),"pub-dialog-published-content-chart-menu-item")}})})}
Y2.prototype.Ja=function(){Y2.oa.Ja.call(this);L(this.getElement(),"pub-dialog-published-content-menu-button");L(this.Pb(),"pub-dialog-published-content-menu-button-content");L(this.zc().getElement(),"pub-dialog-published-content-menu");this.getHandler().V(this,"afterhide",function(a){a.stopPropagation()})};
Y2.prototype.Fs=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.kb(),b instanceof LF?(b=b.Ib(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),kVd(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),kVd(a,b)))):(b=new mVd(vH(b),b.Ib()),a?(a=this.F,a.n9(b)||a.C.push(b)):lVd(this.F,b));this.R=!0;wVd(this)};Y2.prototype.Od=function(a,b){Y2.oa.Od.call(this,a,b);!a&&this.R&&(this.R=!1,this.dispatchEvent(new D("Af")))};
function wVd(a){var b=a.F.F;a.H.Bc(b);z(tBc(a.zc()),function(c){var d=c.kb();d&&(d instanceof LF?(c.Bc(a.F.y9(d.Ib())),c.Pa(!b)):(d=new mVd(vH(d),d.Ib()),c.Bc(a.F.n9(d)),c.Pa(!a.F.y9(d.Fh))))});xVd(a)}
function xVd(a){if(a.F.F)a.setContent("Entire Document");else{var b=Va(a.Ea.D,v(function(a){return this.F.y9(a.Ib())},a)),c=Wa(b,function(a){return a.pe()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.qa.C(d[e].id);f&&b.push(FH(f))}Tea(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.mDa&&d.push(f.value.getTitle())}b=nb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function Z2(a,b){N.call(this,void 0);this.C=new Y2(a,b);this.Ia(this.C,!0);this.D=!1}x(Z2,OUd);Z2.prototype.Ja=function(){Z2.oa.Ja.call(this);L(this.getElement(),"pub-dialog-published-content-container")};Z2.prototype.F=function(){return this.C.F};Z2.prototype.H=function(a){var b=this.C;b.F=a.clone();wVd(b)};Z2.prototype.J=function(a){!a&&this.C.jm()&&(this.D=!0);this.C.Pa(a);a&&this.D&&(this.Qb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function yVd(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+qRd(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return Q(b+a+"</div>")};function zVd(a,b,c,d,e,f,h){var k=null!=h?hVd(h):null;h=new nVd(c,d,k,!0);k=new nVd(c,d,k,!1);V2.call(this,a,b,e,H4a,f,h,k,new Z2(c,d),"/publishingsettings",new AVd);this.rf=c;this.rc=d}x(zVd,V2);
zVd.prototype.EEa=function(a){if(a.entireDocument)return new X2(!0,[],[]);var b=a.charts||"";a=Va((a.sheets||"").split(","),function(a){return null!=OF(this.rf,a)},this);b=Wa(b.split(","),function(a){return parseInt(a,10)});b=Va(b,v(function(a){return!!this.rc.C(a)},this));b=Wa(b,function(a){var b=this.rc.C(a);return new mVd(a,b.Ib())},this);return new X2(!1,a,b)};zVd.prototype.kEa=function(){return new X2(!0,[],[])};
function WUd(a,b){if(b.F||null!=b.Fh){var c="html"==b.D;a=ZUd(a,c?"/pubhtml":"/pub");null!=b.Fh&&(a=ul(a,"gid",b.Fh,"single","true"));c||(a=ul(a,"output",b.D))}else a=ul(ZUd(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function XUd(a,b){var c=WUd(a,b);if(b.F||null!=b.Fh)c=ul(c,"widget","true","headers","false");a=b.C?(a=a.rc.C(b.C.id))?a.ad():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Sb(c)+'"></iframe>'}function AVd(){}x(AVd,N);AVd.prototype.Da=function(){this.Lb(O(yVd,{locale:"en"}))};function BVd(){A.call(this)}x(BVd,Az);p=BVd.prototype;p.seb=function(){return HTd};p.Neb=function(){return ZSd};p.zLb=function(a,b,c,d){var e=new Br;a=new kq(a,b,c,d,void 0,!0,void 0);pq(a,"ok");b=v(e.rb,e);a.wna=b;a.Ba(e);a.Hi=!0;a.C7=yda(Lb);return a};p.sgb=function(){return SSd};p.U5a=function(a,b,c,d,e,f,h){return new BTd(a,b,c,d,e,f,h,void 0)};p.Xeb=function(){return aSd};p.aEa=function(){return qSd};p.lfb=function(){return ASd};p.xgb=function(){return N2};p.wgb=function(){return zVd};
p.dgb=function(){return ISd};p.vgb=function(){return bTd};p.Reb=function(){return $Td};p.tgb=function(){return XTd};p.ugb=function(){return xUd};p.Qeb=function(){return C2};p.ffb=function(){return tRd};p.Ygb=function(){return uRd};Gz("dialogs",BVd);
